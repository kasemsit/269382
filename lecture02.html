

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2. สำรวจชุดข้อมูลขายของออนไลน์ &#8212; 269382 Data Analytics for Non-IT</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lecture02';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="1. สำรวจชุดข้อมูลทิป" href="lecture01.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="269382 Data Analytics for Non-IT - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="269382 Data Analytics for Non-IT - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    269382 Data Analytics for Non-IT Majors
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture01.html">1. สำรวจชุดข้อมูลทิป</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2. สำรวจชุดข้อมูลขายของออนไลน์</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/kasemsit/269382/blob/master/lecture02.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/lecture02.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>สำรวจชุดข้อมูลขายของออนไลน์</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">2. สำรวจชุดข้อมูลขายของออนไลน์</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.1. เริ่มต้นบทเรียน</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2. ดาวน์โหลดข้อมูล</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#excel">2.3. อ่านข้อมูลจากไฟล์ Excel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sheet">2.3.1. อ่าน Sheet เดือนกรกฏาคม</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.2. อ่าน Sheet เดือนสิงหาคม</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1">2.4. Q1. ต้องการนำตารางมาต่อกัน</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-1">2.4.1. Q1.1 การเพิ่มคอลัมน์ที่เก็บค่าเดียวเหมือนกันหมด</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-2">2.4.2. Q1.2 การนำตารางมาต่อกัน</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-3">2.5. Q1.3 การลบคอลัมน์</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-inplace-true">2.6. เกร็ดการใช้ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> (<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-quantity-unitprice">2.7. Q2 ตรวจสอบข้อมูล <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-1-quantity-0-unitprice-0">2.7.1. Q2.1 มี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span> </code> หรือ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code> หรือไม่</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-2-invoiceno-quantity-unitprice">2.7.2. Q2.2 <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> กับ <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoiceno-c-a">2.7.2.1. <strong>1) การเข้าถึงแถวที่ค่าในคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">A</span></code></strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoiceno-c-quantity">2.7.2.2. 2) ถ้า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> แล้ว <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบเสมอ?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.7.2.3. <strong>แบบฝึกหัด</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2">2.8. Q2 การแปลงชนิดข้อมูลให้ถูกประเภท</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe-copy">2.9. เกร็ด: การทำซ้ำข้อมูล <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ด้วย <code class="docutils literal notranslate"><span class="pre">.copy()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy">2.9.1. ทำไมต้องใช้ <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> ?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-missing-value">2.10. Q3 ข้อมูลที่ขาดหาย (Missing value)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-1-nan-dropna-false">2.10.1. Q3.1 ถ้าไม่อยากมองข้าม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ต้องกำหนด <code class="docutils literal notranslate"><span class="pre">dropna=False</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-2">2.10.2. Q3.2 เติมข้อมูลที่ขาดหายด้วยค่าคงที่</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-3-nan">2.10.3. Q3.3 ไม่รู้จะเติม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ด้วยอะไร ก็ลบซะเลย</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-groupby-and-aggregation">2.11. Q4 Groupby and Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-1">2.11.1. Q4.1 จะเข้าถึงกลุ่มย่อยได้อย่างไร</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-2">2.11.2. Q4.2 การทำข้อมูลภาพรวมจากกลุ่มย่อย</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-3-group">2.11.3. Q4.3 จะทราบได้อย่างไรว่า <code class="docutils literal notranslate"><span class="pre">group</span></code> ที่ได้มีกี่กลุ่ม อะไรบ้าง</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-datetime">2.12. Q5 เกี่ยวกับข้อมูลวันที่ (<code class="docutils literal notranslate"><span class="pre">datetime</span></code>)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-1-string-datetime">2.12.1. Q5.1 การแปลง <code class="docutils literal notranslate"><span class="pre">string</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">datetime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-2">2.12.2. Q5.2 การคำนวณส่วนต่างของเวลา</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-3-datetime-series-dataframe">2.12.3. Q5.3 <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ใน <code class="docutils literal notranslate"><span class="pre">Series/DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.12.3.1. เพิ่มคอลัมน์เลขเดือน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.12.3.2. เพิ่มคอลัมน์เลขสัปดาห์</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">2.12.3.3. เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อน 12.00 น. หรือไม่</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">2.12.3.4. เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อนวันคริสต์มาสปี 2011 กี่วัน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoicedate">2.12.3.5. ตอบคำถามว่า <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> แรกสุดและล่าสุดในคือวันและเวลาใด</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q6">2.13. Q6 การรายงานข้อมูลเป็นรายลูกค้า</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">2.13.1. <strong>วิธีที่ 1</strong> ทำ 1,2,และ 3 แล้วค่อยนำมารวมกัน</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoice-invoice-stockcode">2.13.1.1. 1. ลูกค้าแต่ละคน มีจำนวน Invoice เกิดขึ้นกี่ Invoice และเกี่ยวข้องกับสินค้าทั้งหมดกี่ชนิด (<code class="docutils literal notranslate"><span class="pre">StockCode</span></code>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">2.13.1.2. 2. ลูกค้าแต่ละคนเข้ามาแรกสุดและล่าสุดเมื่อใด (จากข้อมูลทั้งหมดที่มี)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">2.13.1.3. 3. ยอดซื้อรวมของลูกค้าแต่ละคน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">2.13.1.4. การนำคอลัมน์มาต่อกัน</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregration">2.13.2. <strong>วิธีที่ 2</strong> การทำ Aggregration โดยการระบุฟังก์ชันจำเพาะกับแต่ละคอลัมน์</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">3. การวาดกราฟ</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleansing">3.1. Data cleansing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3.2. ลูกค้ามาจากไหนบ้าง</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">3.2.1. การแจกแจงจำนวนลูกค้าตามรายประเทศ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">3.3. คำสั่งซื้อจากแต่ละประเทศ เกิดขึ้นก่อนเที่ยงหรือหลังเที่ยง</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">3.4. ปริมาณคำสั่งซื้อต่อวันเป็นอย่างไรบ้าง</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-index">3.4.1. คำสั่ง <code class="docutils literal notranslate"><span class="pre">set_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">2. </span>สำรวจชุดข้อมูลขายของออนไลน์<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p><strong>จุดประสงค์การเรียนรู้</strong></p>
<ol class="arabic simple">
<li><p>การอ่านไฟล์ Excel และการนำข้อมูลตารางมาต่อกัน</p></li>
<li><p>การตรวจสอบความไม่สอดคล้องของข้อมูล</p></li>
<li><p>การตรวจสอบและจัดการข้อมูลที่ขาดหาย (Missing values)</p></li>
<li><p>คำนวณภาพรวมของข้อมูลเป็นกลุ่ม (<code class="docutils literal notranslate"><span class="pre">groupby</span></code>)</p></li>
<li><p>จัดการข้อมูลเกี่ยวกับเวลา</p></li>
<li><p>เรียนรู้การวาดกราฟเพิ่มเติมจากคาบที่ผ่านมา</p></li>
</ol>
<section id="id2">
<h2><span class="section-number">2.1. </span>เริ่มต้นบทเรียน<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>ร้านขายของออนไลน์แห่งหนึ่งได้บันทึกรายการธุรกรรม (transaction) ระหว่างวันที่ 1 กรกฎาคม 2011 ถึง 31 สิงหาคม 2011 ร้านค้ารายนี้จดทะเบียนในสหราชอาณาจักร ขายของใช้เก๋ ๆ ไม่ซ้ำใคร และถึงแม้จะไม่มีหน้าร้าน แต่กลุ่มลูกค้าก็เข้าถึงจากหลากหลายประเทศ</p>
<p>รายละเอียดของแต่ละรายการธุรกรรม มีดังนี้</p>
<p>| คอลัมน์ | คำอธิบาย |
| :– | : – |
| <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> | เลขธุรกรรม (ตัวเลข 6 หลัก) โดยหากมีการขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> จะหมายถึงการยกเลิกสินค้า |
| <code class="docutils literal notranslate"><span class="pre">StockCode</span></code> | รหัสสินค้า (ตัวเลข 5 หลัก) |
| <code class="docutils literal notranslate"><span class="pre">Description</span></code> | ชื่อสินค้า |
| <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> | จำนวนชิ้นที่ซื้อ  |
| <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> | วันและเวลาของธุรกรรม  |
| <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> | ราคาต่อหน่วย |
| <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> | รหัสลูกค้า (ตัวเลข 5 หลัก) |
| <code class="docutils literal notranslate"><span class="pre">Country</span></code> | ประเทศที่อยู่ของลูกค้า |</p>
</section>
<section id="id3">
<h2><span class="section-number">2.2. </span>ดาวน์โหลดข้อมูล<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>ในขั้นแรก จะดาวน์โหลดข้อมูลและบันทึกไว้ในไฟล์ชื่อ <code class="docutils literal notranslate"><span class="pre">data.xlsx</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ใช้คำสั่ง wget ซึ่งเป็นคำสั่ง linux (ไม่ใช่โค้ดภาษา Python) ใน</span>
<span class="o">!</span>wget<span class="w"> </span>-c<span class="w"> </span>https://github.com/kasemsit/269382/raw/main/dataset/online_retail_2months.xlsx<span class="w"> </span>-O<span class="w"> </span>data.xlsx
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2023-11-22 00:08:27--  https://github.com/kasemsit/269382/raw/main/dataset/online_retail_2months.xlsx
Resolving github.com (github.com)... 20.205.243.166
Connecting to github.com (github.com)|20.205.243.166|:443... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>connected.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>302 Found
Location: https://raw.githubusercontent.com/kasemsit/269382/main/dataset/online_retail_2months.xlsx [following]
--2023-11-22 00:08:28--  https://raw.githubusercontent.com/kasemsit/269382/main/dataset/online_retail_2months.xlsx
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.111.133, 185.199.110.133, 185.199.109.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.111.133|:443... connected.
HTTP request sent, awaiting response... 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>416 Range Not Satisfiable

    The file is already fully retrieved; nothing to do.
</pre></div>
</div>
</div>
</div>
<p><strong>คำอธิบาย:</strong> โค้ด <code class="docutils literal notranslate"><span class="pre">!wget</span></code> ข้างต้นไม่ใช่ภาษา Python แต่เป็นการเรียกใช้โปรแกรม <code class="docutils literal notranslate"><span class="pre">wget</span></code> ที่เป็นโปรแกรมของระบบปฏิบัติการ Linux ผ่านทาง command line ดังสังเกตุได้จากเครื่องหมาย <code class="docutils literal notranslate"><span class="pre">!</span></code> นำหน้า ที่เป็นการบอกให้ Google Colab เรียกโปรแกรม <code class="docutils literal notranslate"><span class="pre">wget</span></code> โดยสิ่งที่ตามมา มีความหมายคือ</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code> หมายถึงให้ดาวน์โหลดแบบ resume (คือไม่ต้องดาวน์โหลดใหม่ถ้ามีไฟล์อยู่แล้ว)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https://github.com/kasemsit/269382/raw/main/dataset/online_retail_2months.xlsx</span></code> คือ URL ของไฟล์</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-O</span> <span class="pre">data.xlsx</span></code> หมายถึง ให้ดาวน์โหลดแล้วบันทึกไฟล์ในชื่อ <code class="docutils literal notranslate"><span class="pre">data.xlsx</span></code></p></li>
</ul>
<p>นอกจากนี้ นักศึกษาสามารถเรียกใช้โปรแกรมอื่น ๆ นอกจาก <code class="docutils literal notranslate"><span class="pre">wget</span></code> ได้เช่น <code class="docutils literal notranslate"><span class="pre">!ls</span></code> เพื่อดูว่าโฟลเดอร์ปัจจุบันมีไฟล์อะไรบ้าง หรือแม้กระทั่ง <code class="docutils literal notranslate"><span class="pre">!unzip</span> <span class="pre">ชื่อไฟล์</span></code> เพื่อทำการแตกไฟล์ zip เป็นต้น</p>
<p><strong>ลองทำ:</strong></p>
<ol class="arabic simple">
<li><p>ดาวน์โหลดไฟล์ Excel ไปที่คอมพิวเตอร์ของนักศึกษาด้วย และอ่านไฟล์ด้วยโปรแกรม Excel</p></li>
<li><p>ไฟล์ Excel ที่เก็บข้อมูล มีกี่ Sheet และชื่อ Sheet อะไรบ้าง</p></li>
</ol>
<p>ในขั้นตอนต่อจากนี้ จะเป็นการอ่านไฟล์ Excel ใน Google Colab ด้วย <code class="docutils literal notranslate"><span class="pre">Pandas</span></code></p>
</section>
<section id="excel">
<h2><span class="section-number">2.3. </span>อ่านข้อมูลจากไฟล์ Excel<a class="headerlink" href="#excel" title="Permalink to this heading">#</a></h2>
<p>เมื่อดาวน์โหลดข้อมูลสำเร็จและบันทึกไว้ในไฟล์ <code class="docutils literal notranslate"><span class="pre">data.xlsx</span></code> จากนั้นจึงอ่านไฟล์เข้ามาด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">read_excel()</span></code> ของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html">(ดูคู่มือ)</a> ซึ่งมีรูปแบบ ดังนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">ชื่อไฟล์</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=...</span><span class="p">,</span> <span class="n">header</span><span class="o">=...</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>โดยที่พารามิเตอร์ที่สำคัญที่ใช้บ่อย ได้แก่</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>พารามิเตอร์</p></th>
<th class="head text-left"><p>การกำหนดค่า</p></th>
<th class="head text-left"><p>ค่า default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">sheet_name</span></code></p></td>
<td class="text-left"><p>ชื่อ sheet ที่ต้องการอ่าน หรือตัวเลขลำดับที่ของ sheet</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (sheet แรก)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">skiprows</span></code></p></td>
<td class="text-left"><p>เลขแถวที่จะให้เริ่มอ่านเป็นแถวแรก (แถวแรกนับเป็นแถวที่ <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (แถวแรกของ sheet)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">header</span></code></p></td>
<td class="text-left"><p>ให้ระบุ <code class="docutils literal notranslate"><span class="pre">header=None</span></code> หากไม่มีชื่อคอลัมน์ใน sheet</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (แถวแรกของ sheet เป็น <code class="docutils literal notranslate"><span class="pre">header</span></code>)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">nrows</span></code></p></td>
<td class="text-left"><p>จำนวนแถวที่ต้องการอ่าน (นับจาก <code class="docutils literal notranslate"><span class="pre">header</span></code>)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (อ่านทุกแถวจนจบ sheet)</p></td>
</tr>
</tbody>
</table>
<section id="sheet">
<h3><span class="section-number">2.3.1. </span>อ่าน Sheet เดือนกรกฏาคม<a class="headerlink" href="#sheet" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># บรรทัดนี้ไม่ใช่คำสั่ง Python แต่เป็นคำสั่งพิเศษ (magic command) ของ Google Colab (หรือ iPython) ที่ใช้เคลียร์ตัวแปรในหน่วยความจำ</span>
<span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data_jul</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data.xlsx&#39;</span><span class="p">,</span>
                      <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;July&#39;</span><span class="p">,</span>  <span class="c1"># เดือนกรกฎาคม</span>
                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">File ~/Projects/269382/.venv/lib/python3.10/site-packages/pandas/compat/_optional.py:132,</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, errors, min_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">132</span>     <span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>

<span class="nn">File /usr/lib/python3.10/importlib/__init__.py:126,</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>         <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">126</span> <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1050,</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1027,</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">File &lt;frozen importlib._bootstrap&gt;:1004,</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;openpyxl&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">data_jul</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data.xlsx&#39;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                       <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;July&#39;</span><span class="p">,</span>  <span class="c1"># เดือนกรกฎาคม</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                       <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                       <span class="p">)</span>

<span class="nn">File ~/Projects/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_base.py:504,</span> in <span class="ni">read_excel</span><span class="nt">(io, sheet_name, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, storage_options, dtype_backend, engine_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">ExcelFile</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span>     <span class="n">should_close</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">504</span>     <span class="n">io</span> <span class="o">=</span> <span class="n">ExcelFile</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span>         <span class="n">io</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span>         <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span>         <span class="n">engine_kwargs</span><span class="o">=</span><span class="n">engine_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">509</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span> <span class="k">elif</span> <span class="n">engine</span> <span class="ow">and</span> <span class="n">engine</span> <span class="o">!=</span> <span class="n">io</span><span class="o">.</span><span class="n">engine</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">511</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">512</span>         <span class="s2">&quot;Engine should not be specified when passing &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">513</span>         <span class="s2">&quot;an ExcelFile - ExcelFile already has the engine set&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">514</span>     <span class="p">)</span>

<span class="nn">File ~/Projects/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_base.py:1580,</span> in <span class="ni">ExcelFile.__init__</span><span class="nt">(self, path_or_buffer, engine, storage_options, engine_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1577</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span> <span class="o">=</span> <span class="n">engine</span>
<span class="g g-Whitespace">   </span><span class="mi">1578</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_options</span> <span class="o">=</span> <span class="n">storage_options</span>
<span class="ne">-&gt; </span><span class="mi">1580</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engines</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span>
<span class="g g-Whitespace">   </span><span class="mi">1581</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1582</span>     <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1583</span>     <span class="n">engine_kwargs</span><span class="o">=</span><span class="n">engine_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1584</span> <span class="p">)</span>

<span class="nn">File ~/Projects/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_openpyxl.py:552,</span> in <span class="ni">OpenpyxlReader.__init__</span><span class="nt">(self, filepath_or_buffer, storage_options, engine_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">534</span> <span class="nd">@doc</span><span class="p">(</span><span class="n">storage_options</span><span class="o">=</span><span class="n">_shared_docs</span><span class="p">[</span><span class="s2">&quot;storage_options&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">    </span><span class="mi">535</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">536</span>     <span class="bp">self</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">539</span>     <span class="n">engine_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">542</span><span class="sd">     Reader using openpyxl engine.</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">550</span><span class="sd">         Arbitrary keyword arguments passed to excel engine.</span>
<span class="g g-Whitespace">    </span><span class="mi">551</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">552</span>     <span class="n">import_optional_dependency</span><span class="p">(</span><span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">553</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span>         <span class="n">filepath_or_buffer</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>         <span class="n">engine_kwargs</span><span class="o">=</span><span class="n">engine_kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">557</span>     <span class="p">)</span>

<span class="nn">File ~/Projects/269382/.venv/lib/python3.10/site-packages/pandas/compat/_optional.py:135,</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, errors, min_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">135</span>         <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span>     <span class="k">return</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="c1"># Handle submodules: if we have submodule, grab parent module from sys.modules</span>

<span class="ne">ImportError</span>: Missing optional dependency &#39;openpyxl&#39;.  Use pip or conda to install openpyxl.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_jul</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-332887b4-6ecf-4140-a2c4-0d5f747ac7b0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>558638</td>
      <td>84836</td>
      <td>ZINC METAL HEART DECORATION</td>
      <td>12</td>
      <td>2011-07-01 08:16:00</td>
      <td>1.25</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>558638</td>
      <td>71459</td>
      <td>HANGING JAM JAR T-LIGHT HOLDER</td>
      <td>24</td>
      <td>2011-07-01 08:16:00</td>
      <td>0.85</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>558638</td>
      <td>22784</td>
      <td>LANTERN CREAM GAZEBO</td>
      <td>3</td>
      <td>2011-07-01 08:16:00</td>
      <td>4.95</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>558638</td>
      <td>23145</td>
      <td>ZINC T-LIGHT HOLDER STAR LARGE</td>
      <td>12</td>
      <td>2011-07-01 08:16:00</td>
      <td>0.95</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-332887b4-6ecf-4140-a2c4-0d5f747ac7b0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-332887b4-6ecf-4140-a2c4-0d5f747ac7b0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-332887b4-6ecf-4140-a2c4-0d5f747ac7b0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9147f0b9-0ef7-44f7-b926-e864cca3511d">
  <button class="colab-df-quickchart" onclick="quickchart('df-9147f0b9-0ef7-44f7-b926-e864cca3511d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9147f0b9-0ef7-44f7-b926-e864cca3511d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="id4">
<h3><span class="section-number">2.3.2. </span>อ่าน Sheet เดือนสิงหาคม<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data_aug</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;data.xlsx&#39;</span><span class="p">,</span>
                      <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;August&#39;</span><span class="p">,</span>  <span class="c1"># เดือนสิงหาคม</span>
                      <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                      <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_aug</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3fd547af-75b9-42c6-ad6e-3335fee4abfc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>561904</td>
      <td>22075</td>
      <td>6 RIBBONS ELEGANT CHRISTMAS</td>
      <td>96</td>
      <td>2011-08-01 08:30:00</td>
      <td>1.45</td>
      <td>17941.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>561904</td>
      <td>85049E</td>
      <td>SCANDINAVIAN REDS RIBBONS</td>
      <td>156</td>
      <td>2011-08-01 08:30:00</td>
      <td>1.06</td>
      <td>17941.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>561905</td>
      <td>21385</td>
      <td>IVORY HANGING DECORATION  HEART</td>
      <td>24</td>
      <td>2011-08-01 09:31:00</td>
      <td>0.85</td>
      <td>14947.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>561905</td>
      <td>84970L</td>
      <td>SINGLE HEART ZINC T-LIGHT HOLDER</td>
      <td>12</td>
      <td>2011-08-01 09:31:00</td>
      <td>0.95</td>
      <td>14947.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3fd547af-75b9-42c6-ad6e-3335fee4abfc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3fd547af-75b9-42c6-ad6e-3335fee4abfc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3fd547af-75b9-42c6-ad6e-3335fee4abfc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d1428f27-56e9-4b3c-98a1-08679ec794b0">
  <button class="colab-df-quickchart" onclick="quickchart('df-d1428f27-56e9-4b3c-98a1-08679ec794b0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d1428f27-56e9-4b3c-98a1-08679ec794b0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="q1">
<h2><span class="section-number">2.4. </span>Q1. ต้องการนำตารางมาต่อกัน<a class="headerlink" href="#q1" title="Permalink to this heading">#</a></h2>
<p>สำหรับเนื้อหาในวันนี้ จะพิจารณาข้อมูลทั้ง 2 เดือน ดังนั้นจึงจำเป็นที่ต้องนำตัวแปร <code class="docutils literal notranslate"><span class="pre">data_jul</span></code> และ <code class="docutils literal notranslate"><span class="pre">data_aug</span></code> มาต่อกัน (concatenation)</p>
<section id="q1-1">
<h3><span class="section-number">2.4.1. </span>Q1.1 การเพิ่มคอลัมน์ที่เก็บค่าเดียวเหมือนกันหมด<a class="headerlink" href="#q1-1" title="Permalink to this heading">#</a></h3>
<p>ก่อนที่จะนำตารางมาต่อกัน เราจะเพิ่มคอลัมน์ที่ระบุว่า แต่ละตารางมาจาก Sheet ไหน ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_jul</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;July&#39;</span>    <span class="c1"># สร้างคอลัมน์ใหม่ชื่อ Sheet ใน data_jul ที่มีค่าเท่ากับ July ทั้งหมด</span>
<span class="n">data_aug</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;August&#39;</span>  <span class="c1"># สร้างคอลัมน์ใหม่ชื่อ Sheet ใน data_aug ที่มีค่าเท่ากับ August ทั้งหมด</span>
<span class="n">data_aug</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-35e5d230-2d25-4ffd-a3f7-ac2864b284cf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>561904</td>
      <td>22075</td>
      <td>6 RIBBONS ELEGANT CHRISTMAS</td>
      <td>96</td>
      <td>2011-08-01 08:30:00</td>
      <td>1.45</td>
      <td>17941.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>1</th>
      <td>561904</td>
      <td>85049E</td>
      <td>SCANDINAVIAN REDS RIBBONS</td>
      <td>156</td>
      <td>2011-08-01 08:30:00</td>
      <td>1.06</td>
      <td>17941.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>2</th>
      <td>561905</td>
      <td>21385</td>
      <td>IVORY HANGING DECORATION  HEART</td>
      <td>24</td>
      <td>2011-08-01 09:31:00</td>
      <td>0.85</td>
      <td>14947.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>3</th>
      <td>561905</td>
      <td>84970L</td>
      <td>SINGLE HEART ZINC T-LIGHT HOLDER</td>
      <td>12</td>
      <td>2011-08-01 09:31:00</td>
      <td>0.95</td>
      <td>14947.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>4</th>
      <td>561905</td>
      <td>84970S</td>
      <td>HANGING HEART ZINC T-LIGHT HOLDER</td>
      <td>12</td>
      <td>2011-08-01 09:31:00</td>
      <td>0.85</td>
      <td>14947.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-35e5d230-2d25-4ffd-a3f7-ac2864b284cf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-35e5d230-2d25-4ffd-a3f7-ac2864b284cf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-35e5d230-2d25-4ffd-a3f7-ac2864b284cf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4be03aeb-e94d-4f3a-a229-5a915cd11905">
  <button class="colab-df-quickchart" onclick="quickchart('df-4be03aeb-e94d-4f3a-a229-5a915cd11905')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4be03aeb-e94d-4f3a-a229-5a915cd11905 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="q1-2">
<h3><span class="section-number">2.4.2. </span>Q1.2 การนำตารางมาต่อกัน<a class="headerlink" href="#q1-2" title="Permalink to this heading">#</a></h3>
<p>การนำตารางมาต่อกัน ทำได้ด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> ซึ่งมีรูปแบบการใช้ ดังนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="n">tuple_ที่เก็บตัวแปรตาราง</span> <span class="p">)</span>
</pre></div>
</div>
<p>เช่น หากมีตาราง <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> และ <code class="docutils literal notranslate"><span class="pre">C</span></code> ที่ต้องการนำมาต่อกันตามลำดับ ก็ให้กำหนด <code class="docutils literal notranslate"><span class="pre">tuple_ที่เก็บตัวแปรตาราง</span> <span class="pre">=</span> <span class="pre">(A,</span> <span class="pre">B,</span> <span class="pre">C)</span></code> เป็นต้น โดย <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> จะทำการนำคอลัมน์ของ  <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> และ <code class="docutils literal notranslate"><span class="pre">C</span></code> ที่ชื่อเหมือนกัน มาต่อกัน (ซึ่งหมายความว่า หากในตาราง มีลำดับคอลัมน์ไม่เหมือนกัน แต่ชื่อคอลัมน์ตรงกัน ตารางก็จะยังสามารถนำมาต่อกันได้อย่างถูกต้อง)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="p">(</span><span class="n">data_jul</span><span class="p">,</span> <span class="n">data_aug</span><span class="p">))</span>   <span class="c1"># ต้องการเอา `data_aug` มาต่อท้าย `data_jul`</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0ba06667-473b-40ef-b6ef-fc508b6dbdd5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32441</th>
      <td>564818</td>
      <td>22553</td>
      <td>PLASTERS IN TIN SKULLS</td>
      <td>1</td>
      <td>2011-08-30 12:10:00</td>
      <td>3.29</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>38431</th>
      <td>561870</td>
      <td>22398</td>
      <td>MAGNETS PACK OF 4 SWALLOWS</td>
      <td>12</td>
      <td>2011-07-31 11:45:00</td>
      <td>0.39</td>
      <td>14911.0</td>
      <td>EIRE</td>
      <td>July</td>
    </tr>
    <tr>
      <th>36882</th>
      <td>561658</td>
      <td>22733</td>
      <td>3D TRADITIONAL CHRISTMAS STICKERS</td>
      <td>2</td>
      <td>2011-07-28 16:06:00</td>
      <td>1.25</td>
      <td>12743.0</td>
      <td>Unspecified</td>
      <td>July</td>
    </tr>
    <tr>
      <th>4629</th>
      <td>559037</td>
      <td>82583</td>
      <td>NaN</td>
      <td>10</td>
      <td>2011-07-05 15:29:00</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0ba06667-473b-40ef-b6ef-fc508b6dbdd5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0ba06667-473b-40ef-b6ef-fc508b6dbdd5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0ba06667-473b-40ef-b6ef-fc508b6dbdd5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-96fab07d-60fc-42bc-a752-58bbfc918ca3">
  <button class="colab-df-quickchart" onclick="quickchart('df-96fab07d-60fc-42bc-a752-58bbfc918ca3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-96fab07d-60fc-42bc-a752-58bbfc918ca3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>สำหรับข้อมูลในวันนี้ ทั้ง <code class="docutils literal notranslate"><span class="pre">data_jul</span></code> และ <code class="docutils literal notranslate"><span class="pre">data_aug</span></code>  มีชื่อคอลัมน์เหมือนกัน จึงสามารถนำมาต่อกันได้โดยง่าย</p>
<p>อย่างไรก็ตาม <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ที่ได้จากการต่อตาราง จะมี <code class="docutils literal notranslate"><span class="pre">index</span></code> ที่ซ้ำกัน เพราะว่า <code class="docutils literal notranslate"><span class="pre">index</span></code> ของทั้ง <code class="docutils literal notranslate"><span class="pre">data_jul</span></code> และ <code class="docutils literal notranslate"><span class="pre">data_aug</span></code> ต่างเริ่มนับจาก <code class="docutils literal notranslate"><span class="pre">0</span></code> ปัญหานี้ สามารถตรวจสอบได้ เช่น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">555</span><span class="p">]</span>  <span class="c1"># พิมพ์แถวที่มี index เท่ากับ 555 ออกมา ซึ่งจะพบว่ามีซ้ำกัน 2 แถว (แต่ละแถวมาจากแต่ละ Sheet)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-672ce5f3-accf-4939-b20f-c1603112f044" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>555</th>
      <td>558702</td>
      <td>23146</td>
      <td>TRIPLE HOOK ANTIQUE IVORY ROSE</td>
      <td>2</td>
      <td>2011-07-01 12:45:00</td>
      <td>3.29</td>
      <td>12748.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>555</th>
      <td>561968</td>
      <td>23152</td>
      <td>IVORY SWEETHEART WIRE LETTER RACK</td>
      <td>2</td>
      <td>2011-08-01 13:29:00</td>
      <td>3.75</td>
      <td>16332.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-672ce5f3-accf-4939-b20f-c1603112f044')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-672ce5f3-accf-4939-b20f-c1603112f044 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-672ce5f3-accf-4939-b20f-c1603112f044');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2556a2eb-10a9-4675-b400-ec5e2c065d3a">
  <button class="colab-df-quickchart" onclick="quickchart('df-2556a2eb-10a9-4675-b400-ec5e2c065d3a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2556a2eb-10a9-4675-b400-ec5e2c065d3a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>การที่ <code class="docutils literal notranslate"><span class="pre">index</span></code> มีค่าซ้ำกัน อาจทำให้เกิดความผิดพลาดในการคำนวณในอนาคต ดังนั้น หากไม่ต้องการให้ <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> ใช้ <code class="docutils literal notranslate"><span class="pre">index</span></code> เดิม (ซึ่งสร้างอัตโนมัติมา) แต่ให้สร้าง <code class="docutils literal notranslate"><span class="pre">index</span></code> ใหม่ ก็ทำได้ด้วยการเพิ่มพารามิเตอร์ <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="p">(</span><span class="n">data_jul</span><span class="p">,</span> <span class="n">data_aug</span><span class="p">),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">555</span><span class="p">]</span>   <span class="c1"># คราวนี้จะเห็นว่า index เท่ากับ 555 มีแถวเดียว</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-959a99f1-377d-4f2e-bd90-15276fec8957" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>555</th>
      <td>558702</td>
      <td>23146</td>
      <td>TRIPLE HOOK ANTIQUE IVORY ROSE</td>
      <td>2</td>
      <td>2011-07-01 12:45:00</td>
      <td>3.29</td>
      <td>12748.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-959a99f1-377d-4f2e-bd90-15276fec8957')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-959a99f1-377d-4f2e-bd90-15276fec8957 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-959a99f1-377d-4f2e-bd90-15276fec8957');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<p><strong>ลองทำ:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> ทำให้สูญเสีย <code class="docutils literal notranslate"><span class="pre">index</span></code> ของข้อมูลเดิม ซึ่งอาจเป็นปัญหาในกรณีที่ต้องการเข้าถึงค่า <code class="docutils literal notranslate"><span class="pre">index</span></code> เดิม ดังนั้น หากต้องการเก็บค่า <code class="docutils literal notranslate"><span class="pre">index</span></code> เดิมไว้ จะต้องทำอย่างไร (ใช้ความรู้จากคาบก่อน)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># เฉลย</span>
<span class="n">data_jul_reset_index</span> <span class="o">=</span> <span class="n">data_jul</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>  <span class="c1"># จะมีคอลัมน์ชื่อ index เพิ่มเข้ามา</span>
<span class="n">data_aug_reset_index</span> <span class="o">=</span> <span class="n">data_aug</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="p">(</span><span class="n">data_jul_reset_index</span><span class="p">,</span> <span class="n">data_aug_reset_index</span><span class="p">),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f3f5259a-e66e-45b8-9272-fac53408590c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43431</th>
      <td>3913</td>
      <td>562264</td>
      <td>21700</td>
      <td>BIG DOUGHNUT FRIDGE MAGNETS</td>
      <td>6</td>
      <td>2011-08-03 16:14:00</td>
      <td>1.38</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>20979</th>
      <td>20979</td>
      <td>560272</td>
      <td>22352</td>
      <td>LUNCH BOX WITH CUTLERY RETROSPOT</td>
      <td>6</td>
      <td>2011-07-17 14:56:00</td>
      <td>2.55</td>
      <td>12691.0</td>
      <td>France</td>
      <td>July</td>
    </tr>
    <tr>
      <th>57850</th>
      <td>18332</td>
      <td>563552</td>
      <td>22171</td>
      <td>3 HOOK PHOTO SHELF ANTIQUE WHITE</td>
      <td>4</td>
      <td>2011-08-17 13:06:00</td>
      <td>8.50</td>
      <td>17656.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>21281</th>
      <td>21281</td>
      <td>560290</td>
      <td>21930</td>
      <td>JUMBO STORAGE BAG SKULLS</td>
      <td>1</td>
      <td>2011-07-18 10:17:00</td>
      <td>4.96</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f3f5259a-e66e-45b8-9272-fac53408590c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f3f5259a-e66e-45b8-9272-fac53408590c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f3f5259a-e66e-45b8-9272-fac53408590c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fa00a977-303f-4230-bbf6-ea2d3db0a96b">
  <button class="colab-df-quickchart" onclick="quickchart('df-fa00a977-303f-4230-bbf6-ea2d3db0a96b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fa00a977-303f-4230-bbf6-ea2d3db0a96b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="q1-3">
<h2><span class="section-number">2.5. </span>Q1.3 การลบคอลัมน์<a class="headerlink" href="#q1-3" title="Permalink to this heading">#</a></h2>
<p>สมมติว่า ไม่ต้องการใช้คอลัมน์ <code class="docutils literal notranslate"><span class="pre">Sheet</span></code> ทีสร้างขึ้นอีกแล้ว และอยากจะลบออกจาก <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> เลย จะลบได้โดยใช้ฟังก์ชัน</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DataFrame</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>โดยที่ <code class="docutils literal notranslate"><span class="pre">columns</span></code> คือชื่อคอลัมน์หรือรายการชื่อคอลัมน์ที่ต้องการลบ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">])</span> <span class="c1"># จะเห็นว่าผลลัพธ์ที่ได้ คอลัมน์ Sheet หายไป</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d8b0b3ae-1393-4dbf-8329-582221a0fae9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>558638</td>
      <td>84836</td>
      <td>ZINC METAL HEART DECORATION</td>
      <td>12</td>
      <td>2011-07-01 08:16:00</td>
      <td>1.25</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>558638</td>
      <td>71459</td>
      <td>HANGING JAM JAR T-LIGHT HOLDER</td>
      <td>24</td>
      <td>2011-07-01 08:16:00</td>
      <td>0.85</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>558638</td>
      <td>22784</td>
      <td>LANTERN CREAM GAZEBO</td>
      <td>3</td>
      <td>2011-07-01 08:16:00</td>
      <td>4.95</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>558638</td>
      <td>23145</td>
      <td>ZINC T-LIGHT HOLDER STAR LARGE</td>
      <td>12</td>
      <td>2011-07-01 08:16:00</td>
      <td>0.95</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>558638</td>
      <td>22674</td>
      <td>FRENCH TOILET SIGN BLUE METAL</td>
      <td>12</td>
      <td>2011-07-01 08:16:00</td>
      <td>1.25</td>
      <td>16317.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>74797</th>
      <td>35279</td>
      <td>C565077</td>
      <td>23196</td>
      <td>VINTAGE LEAF MAGNETIC NOTEPAD</td>
      <td>-3</td>
      <td>2011-08-31 17:31:00</td>
      <td>1.45</td>
      <td>17451.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>74798</th>
      <td>35280</td>
      <td>C565077</td>
      <td>22189</td>
      <td>CREAM HEART CARD HOLDER</td>
      <td>-1</td>
      <td>2011-08-31 17:31:00</td>
      <td>3.95</td>
      <td>17451.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>74799</th>
      <td>35281</td>
      <td>C565077</td>
      <td>23239</td>
      <td>SET OF 4 KNICK KNACK TINS POPPIES</td>
      <td>-1</td>
      <td>2011-08-31 17:31:00</td>
      <td>4.15</td>
      <td>17451.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>74800</th>
      <td>35282</td>
      <td>C565077</td>
      <td>23197</td>
      <td>SKETCHBOOK MAGNETIC SHOPPING LIST</td>
      <td>-12</td>
      <td>2011-08-31 17:31:00</td>
      <td>1.45</td>
      <td>17451.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>74801</th>
      <td>35283</td>
      <td>C565078</td>
      <td>D</td>
      <td>Discount</td>
      <td>-1</td>
      <td>2011-08-31 17:45:00</td>
      <td>57.60</td>
      <td>16422.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>74802 rows × 9 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d8b0b3ae-1393-4dbf-8329-582221a0fae9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d8b0b3ae-1393-4dbf-8329-582221a0fae9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d8b0b3ae-1393-4dbf-8329-582221a0fae9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-82d17bd1-570c-4a66-b3b9-128134b39168">
  <button class="colab-df-quickchart" onclick="quickchart('df-82d17bd1-570c-4a66-b3b9-128134b39168')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-82d17bd1-570c-4a66-b3b9-128134b39168 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="pandas-inplace-true">
<h2><span class="section-number">2.6. </span>เกร็ดการใช้ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> (<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>)<a class="headerlink" href="#pandas-inplace-true" title="Permalink to this heading">#</a></h2>
<p>ฟังก์ชันที่แก้ไข <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>อย่างเช่นฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">DataFrame.drop()</span></code> ฯลฯ มันไม่เขียนทับต้นฉบับเดิม ดังนั้นเวลาจะนำไปใช้ต่อ จึงต้อง assign ค่าให้ตัวแปรใหม่ หรือหากต้องการเขียนทับตัวแปรเดิม ในตัวอย่างก่อนหน้า ก็จะต้องเขียนว่า</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">])</span>   <span class="c1"># แบบที่ 1</span>
</pre></div>
</div>
<p>หรืออีกทางเลือกหนึ่ง ซึ่ง <code class="docutils literal notranslate"><span class="pre">Pandas</span></code>  อำนวยความสะดวกให้ในกรณีที่ต้องการเขียนทับต้นฉบับ คือการกำหนดพารามิเตอร์ <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> ดังนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1"># แบบที่ 2</span>
</pre></div>
</div>
<p>ซึ่งหากเขียนแบบนี้แล้ว ก็ไม่ต้องนำตัวแปรมารับค่าอีก ซึ่งหากทำดังโค้ดต่อไปนี้ ก็จะเกิดข้อผิดพลาด นำตัวแปร <code class="docutils literal notranslate"><span class="pre">data</span></code> ไปใช่ต่อไปไม่ได้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ผิดพลาด!! ทำแบบนี้แล้ว data ที่ได้จะเป็นค่า None</span>
 <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sheet&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
 <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># จะได้ None</span>
</pre></div>
</div>
<p>สาเหตุที่เป็นเช่นนี้ก็เพราะ</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inplace=False</span></code> ทำให้ฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">return</span></code> ตัวแปรที่ผ่านการแก้ไข แต่ต้นฉบับเดิมยังไม่เปลี่ยน</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> ทำให้ฟังก์ชันแก้ตัวแปรต้นฉบับ พร้อมกับ <code class="docutils literal notranslate"><span class="pre">return</span></code> ค่า <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>คำแนะนำ</strong></p>
<ul class="simple">
<li><p>เลือกใช้ตามความเหมาะสม</p></li>
</ul>
</section>
<section id="q2-quantity-unitprice">
<h2><span class="section-number">2.7. </span>Q2 ตรวจสอบข้อมูล <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code><a class="headerlink" href="#q2-quantity-unitprice" title="Permalink to this heading">#</a></h2>
<p>เนื่องจากข้อมูลที่ได้รับมา อาจมีความไม่ถูกต้องในข้อมูลอยู่ด้วย ยกตัวอย่างเช่น หากลองสุ่มแถวมาดูเรื่อย ๆ จะพบสิ่งผิดปกติ  บางแถวมี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบ หรือแม้กระทั่ง <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> ติดลบ ซึ่งเราไม่ทราบว่ามีที่มาอย่างไร ดังนี้ เราจะลองเข้าไปดูหัวข้อนี้</p>
<section id="q2-1-quantity-0-unitprice-0">
<h3><span class="section-number">2.7.1. </span>Q2.1 มี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span> </code> หรือ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code> หรือไม่<a class="headerlink" href="#q2-1-quantity-0-unitprice-0" title="Permalink to this heading">#</a></h3>
<p>ก่อนอื่น จะสุ่มพิมพ์แถวที่มี <code class="docutils literal notranslate"><span class="pre">'Quantity'</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> จะพบว่ามี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบอยู่จริง</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># Quantity &lt; 0 ได้อย่างไร?</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ff0b628c-092d-46c3-b9fb-c6c0ebc529a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24178</th>
      <td>24178</td>
      <td>C560540</td>
      <td>23190</td>
      <td>BUNDLE OF 3 SCHOOL EXERCISE BOOKS</td>
      <td>-1</td>
      <td>2011-07-19 12:26:00</td>
      <td>1.65</td>
      <td>12415.0</td>
      <td>Australia</td>
      <td>July</td>
    </tr>
    <tr>
      <th>32043</th>
      <td>32043</td>
      <td>C561198</td>
      <td>M</td>
      <td>Manual</td>
      <td>-35</td>
      <td>2011-07-25 14:45:00</td>
      <td>1.25</td>
      <td>16161.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>42516</th>
      <td>2998</td>
      <td>C562159</td>
      <td>M</td>
      <td>Manual</td>
      <td>-12</td>
      <td>2011-08-03 11:48:00</td>
      <td>1.45</td>
      <td>17389.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>9537</th>
      <td>9537</td>
      <td>C559347</td>
      <td>85159A</td>
      <td>BLACK TEA,COFFEE,SUGAR JARS</td>
      <td>-24</td>
      <td>2011-07-07 17:22:00</td>
      <td>1.95</td>
      <td>18072.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>74671</th>
      <td>35153</td>
      <td>C565025</td>
      <td>82494L</td>
      <td>WOODEN FRAME ANTIQUE WHITE</td>
      <td>-2</td>
      <td>2011-08-31 16:32:00</td>
      <td>2.95</td>
      <td>13050.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ff0b628c-092d-46c3-b9fb-c6c0ebc529a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ff0b628c-092d-46c3-b9fb-c6c0ebc529a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ff0b628c-092d-46c3-b9fb-c6c0ebc529a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-1bd37921-ccbc-4def-8b3a-a2ddc3c4de29">
  <button class="colab-df-quickchart" onclick="quickchart('df-1bd37921-ccbc-4def-8b3a-a2ddc3c4de29')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-1bd37921-ccbc-4def-8b3a-a2ddc3c4de29 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p><strong>ลองทำ:</strong> จงหาว่า <code class="docutils literal notranslate"><span class="pre">'UnitPrice'</span></code> ที่เป็นลบ มาทั้งหมดกี่แถว</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># เฉลย</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># จะเห็น InvoiceNo มีตัว A นำหน้าด้วย</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-899f57bd-55da-44d9-93c6-4bcc8f68f2c8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54080</th>
      <td>14562</td>
      <td>A563186</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>2011-08-12 14:51:00</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>54081</th>
      <td>14563</td>
      <td>A563187</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>2011-08-12 14:52:00</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-899f57bd-55da-44d9-93c6-4bcc8f68f2c8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-899f57bd-55da-44d9-93c6-4bcc8f68f2c8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-899f57bd-55da-44d9-93c6-4bcc8f68f2c8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d1cb02ca-7b41-4059-b4a1-668f01e48d80">
  <button class="colab-df-quickchart" onclick="quickchart('df-d1cb02ca-7b41-4059-b4a1-668f01e48d80')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d1cb02ca-7b41-4059-b4a1-668f01e48d80 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="q2-2-invoiceno-quantity-unitprice">
<h3><span class="section-number">2.7.2. </span>Q2.2 <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> กับ <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code><a class="headerlink" href="#q2-2-invoiceno-quantity-unitprice" title="Permalink to this heading">#</a></h3>
<p>จากผลการพิมพ์แถวที่มี <code class="docutils literal notranslate"><span class="pre">'UnitPrice'</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>จะพบความผิดปกติของข้อมูลที่ไม่สอดคล้องกับคำอธิบายข้อมูล (Data dictionary) ที่ผู้แจกจ่ายข้อมูลให้มา นี่เป็นปัญหาปกติที่ต้องเผชิญอย่างหลีกเลี่ยงไม่ได้ ก่อนที่จะสามารถทำข้อมูลไปใช้ประโยชน์ได้</p>
<p>Data dictionary บอกทราบว่า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> เป็นเลข 6 หลัก ที่หากขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">'C'</span></code> จะหมายถึงการยกเลิกสินค้า แต่จากการพิมพ์แถวที่ <code class="docutils literal notranslate"><span class="pre">'UnitPrice'</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>จะพบ  <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">'A'</span></code> ด้วย ดังนั้นในหัวข้อนี้จะเจาะลึกคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code></p>
<p><strong>คำถามที่ต้องการตอบ</strong></p>
<ol class="arabic simple">
<li><p>จะเข้าถึงแถวที่ค่าในคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">A</span></code> ได้อย่างไร</p></li>
<li><p>ถ้า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> แล้ว <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code> เสมอ?</p></li>
</ol>
<p>เพื่อที่จะได้คำตอบ จะทำเป็นขั้น ๆ ดังนี้</p>
<section id="invoiceno-c-a">
<h4><span class="section-number">2.7.2.1. </span><strong>1) การเข้าถึงแถวที่ค่าในคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">A</span></code></strong><a class="headerlink" href="#invoiceno-c-a" title="Permalink to this heading">#</a></h4>
<p><em><strong>ตรวจสอบว่าคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> เก็บข้อมูลชนิดใด</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>    <span class="c1"># จะใช้คำสั่ง data.info() จากคาบก่อนเพื่อตรวจดูก็ได้</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype(&#39;O&#39;)
</pre></div>
</div>
</div>
</div>
<p>จะเห็นว่า เป็นชนิดแบบผสม (<code class="docutils literal notranslate"><span class="pre">dtype('O')</span></code> คือ <code class="docutils literal notranslate"><span class="pre">object</span></code>)</p>
<p><strong>แปลงชนิดข้อมูลของคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code></strong></p>
<p>การที่ข้อมูล <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> เป็นชนิด <code class="docutils literal notranslate"><span class="pre">object</span></code> จะยากแก่การตรวจสอบว่า แต่ละค่าขึ้นต้นด้วยอักษร <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือไม่ ดังนั้นจึงจะแปลงชนิดข้อมูลในคอลัมน์นี้ ให้เป็นชนิด <code class="docutils literal notranslate"><span class="pre">string</span></code> เสียก่อน ด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">Series.astype('string')</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># หมายเหตุ: คอลัมน์อื่น ๆ ที่จำเป็นต้องแปลงข้อมูลให้ถูกต้องก็มีอีกหลายคอลัมน์ แต่ขอข้ามไปก่อน</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>  <span class="c1"># แปลงแล้วเขียนทับลงคอลัมน์เดิม</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>string[python]
</pre></div>
</div>
</div>
</div>
<p><strong>ตรวจสอบว่า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือไม่</strong></p>
<p>เมื่อคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ถูกแปลงเป็นชนิด <code class="docutils literal notranslate"><span class="pre">string</span></code> แล้ว จะสามารถใช้ฟังก์ชันเกี่ยวกับ <code class="docutils literal notranslate"><span class="pre">string</span></code> ของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> ได้อย่างอิสระ</p>
<p>การจะเข้าถึงสมาชิกแต่ละตัวของ <code class="docutils literal notranslate"><span class="pre">Series</span></code> ที่เก็บ <code class="docutils literal notranslate"><span class="pre">string</span></code> ได้นั้น จะต้องกระทำผ่านตัวช่วยที่เรียกว่า <strong>String method</strong> (<code class="docutils literal notranslate"><span class="pre">.str</span></code>) ดังรูปแบบ ต่อไปนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Series</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">ฟังก์ชันสตริง</span>
</pre></div>
</div>
<p>ซึ่งตัวอย่างของฟังก์ชัน ได้แก่</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>ฟังก์ชันสตริง</p></th>
<th class="head text-left"><p>ตัวอย่างการใช้งาน</p></th>
<th class="head text-left"><p>คำอธิบาย</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">startswith()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.startswith('H')</span></code></p></td>
<td class="text-left"><p>เช็คว่าอักษรตัวแรกเป็น <code class="docutils literal notranslate"><span class="pre">H</span></code> หรือไม่</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">endswith()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.endswith('y')</span></code></p></td>
<td class="text-left"><p>เช็คว่าอักษรตัวสุดท้ายเป็น <code class="docutils literal notranslate"><span class="pre">y</span></code> หรือไม่</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">lstrip()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.lstrip('ah')</span></code></p></td>
<td class="text-left"><p>ไล่ลบตัวอักษร <code class="docutils literal notranslate"><span class="pre">a</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">h</span></code> โดยเริ่มลบจากทางซ้ายไปขวา และลบจนกว่าจะเจออักษรที่ไม่ใช่ <code class="docutils literal notranslate"><span class="pre">a</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">h</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.lstrip()</span></code></p></td>
<td class="text-left"><p>ลบช่องว่างด้านซ้าย</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">rstrip()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.rstrip()</span></code></p></td>
<td class="text-left"><p>คล้าย <code class="docutils literal notranslate"><span class="pre">lstrip()</span></code> แต่ไล่ลบเริ่มจากด้านขวา</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">strip()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.strip()</span></code></p></td>
<td class="text-left"><p>กระทำทั้ง <code class="docutils literal notranslate"><span class="pre">lstrip()</span></code> และ <code class="docutils literal notranslate"><span class="pre">rstrip()</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">len()</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Series.str.len()</span></code></p></td>
<td class="text-left"><p>นับจำนวนตัวอักษร</p></td>
</tr>
</tbody>
</table>
<p>สำหรับตัวอย่างการใช้งาน String method ของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> อื่น ๆ ศึกษาเพิ่มเติมได้จาก <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/text.html#string-methods">ลิงค์</a> และ<a class="reference external" href="https://pandas.pydata.org/docs/user_guide/text.html#method-summary">ตารางสรุปฟังก์ชัน</a></p>
<p>ในกรณีนี้ เราต้องการตรวจสอบว่า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วยอักษร <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือไม่ จึงใช้ <code class="docutils literal notranslate"><span class="pre">startswith()</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flag_c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>  <span class="c1"># True คือขึ้นต้นด้วย C ส่วน False ไม่ขึ้นต้นด้วย C</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_c</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">flag_c</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invoice ขึ้นต้นด้วย C มี </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_c</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว&#39;</span><span class="p">)</span>
<span class="n">data_c</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Invoice ขึ้นต้นด้วย C มี 1353 แถว
</pre></div>
</div>
<div class="output text_html">
  <div id="df-eb525ddb-e542-4439-b507-064cb3df1da8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63791</th>
      <td>24273</td>
      <td>C564138</td>
      <td>21218</td>
      <td>RED SPOTTY BISCUIT TIN</td>
      <td>-3</td>
      <td>2011-08-23 11:36:00</td>
      <td>3.25</td>
      <td>12753.0</td>
      <td>Japan</td>
      <td>August</td>
    </tr>
    <tr>
      <th>67048</th>
      <td>27530</td>
      <td>C564424</td>
      <td>15039</td>
      <td>SANDALWOOD FAN</td>
      <td>-20</td>
      <td>2011-08-25 11:10:00</td>
      <td>0.85</td>
      <td>12955.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>47914</th>
      <td>8396</td>
      <td>C562620</td>
      <td>22801</td>
      <td>ANTIQUE GLASS PEDESTAL BOWL</td>
      <td>-1</td>
      <td>2011-08-08 12:34:00</td>
      <td>3.75</td>
      <td>13089.0</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>4037</th>
      <td>4037</td>
      <td>C558969</td>
      <td>22728</td>
      <td>ALARM CLOCK BAKELIKE PINK</td>
      <td>-1</td>
      <td>2011-07-05 11:01:00</td>
      <td>3.75</td>
      <td>16729.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>4526</th>
      <td>4526</td>
      <td>C559030</td>
      <td>21868</td>
      <td>POTTING SHED TEA MUG</td>
      <td>-2</td>
      <td>2011-07-05 14:51:00</td>
      <td>1.25</td>
      <td>16571.0</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-eb525ddb-e542-4439-b507-064cb3df1da8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-eb525ddb-e542-4439-b507-064cb3df1da8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-eb525ddb-e542-4439-b507-064cb3df1da8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-996f87a2-3efc-43b7-82a8-4c436710ef75">
  <button class="colab-df-quickchart" onclick="quickchart('df-996f87a2-3efc-43b7-82a8-4c436710ef75')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-996f87a2-3efc-43b7-82a8-4c436710ef75 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>และในลักษณะเดียวกัน สามารถเข้าถึงแถวที่ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">'A'</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flag_a</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">data_a</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">flag_a</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invoice ขึ้นต้นด้วย A มี </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_a</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว&#39;</span><span class="p">)</span>
<span class="n">data_a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Invoice ขึ้นต้นด้วย A มี 3 แถว
</pre></div>
</div>
<div class="output text_html">
  <div id="df-debdbb78-4b18-4f07-9865-8a35045b4395" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54079</th>
      <td>14561</td>
      <td>A563185</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>2011-08-12 14:50:00</td>
      <td>11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>54080</th>
      <td>14562</td>
      <td>A563186</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>2011-08-12 14:51:00</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>54081</th>
      <td>14563</td>
      <td>A563187</td>
      <td>B</td>
      <td>Adjust bad debt</td>
      <td>1</td>
      <td>2011-08-12 14:52:00</td>
      <td>-11062.06</td>
      <td>NaN</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-debdbb78-4b18-4f07-9865-8a35045b4395')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-debdbb78-4b18-4f07-9865-8a35045b4395 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-debdbb78-4b18-4f07-9865-8a35045b4395');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fd04735e-6786-444f-b9fd-4c07678008c8">
  <button class="colab-df-quickchart" onclick="quickchart('df-fd04735e-6786-444f-b9fd-4c07678008c8')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fd04735e-6786-444f-b9fd-4c07678008c8 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="invoiceno-c-quantity">
<h4><span class="section-number">2.7.2.2. </span>2) ถ้า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> แล้ว <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบเสมอ?<a class="headerlink" href="#invoiceno-c-quantity" title="Permalink to this heading">#</a></h4>
<p>นับจำนวนแถวของ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ที่เป็นการยกเลิก และมี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_c</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># ในบรรดา Invoice ที่ขึ้นต้นด้วย C</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data_c</span><span class="p">[</span><span class="n">flags</span><span class="p">])</span>    <span class="c1"># Invoice ขึ้นต้นด้วย C และ Quantity &lt; 0 มี 1353 แถว ซึ่งเท่ากับจำนวนแถวทั้งหมดของ data_c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1353
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_c</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data_c</span><span class="p">[</span><span class="n">flags</span><span class="p">])</span>   <span class="c1"># ไม่มี Invoice ขึ้นต้นด้วย C ที่มี Quantity &gt; 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>ดังนั้นจากข้อมูลที่มี จึงสรุปได้ว่า ถ้า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> แล้ว <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> จะน้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code> เสมอ</p>
<p>นอกจากนี้ เรายังพบอีกว่า คอลัมน์ <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ไม่มีค่าที่เท่ากับ <code class="docutils literal notranslate"><span class="pre">0</span></code> เลย</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># เช็คข้อมูลทั้งหมด</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">flags</span><span class="p">])</span>   <span class="c1"># ไม่พบว่าในชุดข้อมูลทั้งหมดมีการบันทึกค่า Quantity == 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h4><span class="section-number">2.7.2.3. </span><strong>แบบฝึกหัด</strong><a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h4>
<p>จงเติมตารางต่อไปนี้ให้สมบูรณ์ (ช่องที่เป็นเครื่องหมาย <code class="docutils literal notranslate"><span class="pre">?</span></code> เป็นค่าอะไร)</p>
<p><em>หมายเหตุ:</em> เราทราบก่อนหน้าแล้วว่า <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ไม่เคยเท่ากับ <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p><code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code></p></th>
<th class="head text-left"><p><code class="docutils literal notranslate"><span class="pre">Quantity</span></code></p></th>
<th class="head text-left"><p><code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code></p></th>
<th class="head text-right"><p>จำนวนแถว</p></th>
<th class="head text-left"><p>สมมติฐาน</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">==</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>1353</p></td>
<td class="text-left"><p>การคืนสินค้า จะใส่ <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบ  แต่ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> อาจจะเป็น <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> ที่ซื้อไป จึงเป็นบวก</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">==</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>73128</p></td>
<td class="text-left"><p>รายการขายออกไป จึงมีแต่ค่าบวก (แต่มีรายการที่ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">A</span></code> อยู่ 1 รายการ )</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">==</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p><strong>?</strong></p></td>
<td class="text-left"><p>หลากหลายเหตุผลที่ไม่อาจทราบได้ เช่นอาจเป็นสินค้าที่คิดว่าเสียหาย แต่เพิ่งเจอใน stock, อาจลงเลขผิด ฯลฯ</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>2</p></td>
<td class="text-left"><p>รายการที่ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">==</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p><strong>?</strong></p></td>
<td class="text-left"><p>หลากหลายเหตุผลที่ไม่อาจทราบได้ เช่นอาจเป็นสินค้าที่เสียหาย ที่ไม่ได้ขายออกไป, อาจลงเลขผิด ฯลฯ</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>not <code class="docutils literal notranslate"><span class="pre">C</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code></p></td>
<td class="text-right"><p>0</p></td>
<td class="text-left"><p></p></td>
</tr>
<tr class="row-even"><td class="text-left"><p></p></td>
<td class="text-left"><p></p></td>
<td class="text-left"><p>รวม</p></td>
<td class="text-right"><p>74802</p></td>
<td class="text-left"><p></p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># เฉลย</span>
<span class="n">ans1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">ans2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;คำตอบคือ </span><span class="si">{</span><span class="n">ans1</span><span class="si">}</span><span class="s1"> กับ </span><span class="si">{</span><span class="n">ans2</span><span class="si">}</span><span class="s1"> ตามลำดับ&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>คำตอบคือ 152 กับ 167 ตามลำดับ
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="q2">
<h2><span class="section-number">2.8. </span>Q2 การแปลงชนิดข้อมูลให้ถูกประเภท<a class="headerlink" href="#q2" title="Permalink to this heading">#</a></h2>
<p>ข้อมูลแต่ละคอลัมน์ใน <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ถูกกำหนดชนิดข้อมูลโดยอัตโนมัติ ซึ่งอาจมีความผิดพลาดได้ ดังนั้น จึงเป็นหน้าที่ของนักวิเคราห์ข้อมูลที่จำต้องกำหนดให้ถูกต้องแต่เนิ่น ๆ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 74802 entries, 0 to 74801
Data columns (total 10 columns):
 #   Column       Non-Null Count  Dtype         
---  ------       --------------  -----         
 0   index        74802 non-null  int64         
 1   InvoiceNo    74802 non-null  string        
 2   StockCode    74802 non-null  object        
 3   Description  74565 non-null  object        
 4   Quantity     74802 non-null  int64         
 5   InvoiceDate  74802 non-null  datetime64[ns]
 6   UnitPrice    74802 non-null  float64       
 7   CustomerID   55164 non-null  float64       
 8   Country      74802 non-null  object        
 9   Sheet        74802 non-null  object        
dtypes: datetime64[ns](1), float64(2), int64(2), object(4), string(1)
memory usage: 5.7+ MB
</pre></div>
</div>
</div>
</div>
<p>จาก <code class="docutils literal notranslate"><span class="pre">data.info()</span></code> จะพบว่า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ถูกแปลงไว้ถูกต้องแล้วจากหัวข้อที่แล้ว</p>
<p>ส่วนคอลัมน์อื่น ๆ จะแปลงด้วยโค้ดด้านล่างนี้ โดยที่</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'Int64'</span></code> คือตัวแปรจำนวนเต็ม (integer) ขนาด 64 บิต ที่รองรับการเก็บค่า <code class="docutils literal notranslate"><span class="pre">NaN</span></code></p></li>
</ul>
<p><strong>คำถาม:</strong> ขอให้นักศึกษาอภิปรายประเด็นต่อไปนี้</p>
<ol class="arabic simple">
<li><p>เดิม <code class="docutils literal notranslate"><span class="pre">'StockCode'</span></code> เป็นประเภท <code class="docutils literal notranslate"><span class="pre">object</span></code> นั้นไม่ดีอย่างไร แล้วทำไมไม่แปลงเป็น <code class="docutils literal notranslate"><span class="pre">int</span></code></p></li>
<li><p>ทำไมไม่แปลง <code class="docutils literal notranslate"><span class="pre">'CustomerID'</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">int</span></code> หรือ?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;StockCode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;StockCode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>    <span class="c1"># ทำไมไม่เป็น .astype(int)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>   <span class="c1"># ทำไมไม่เป็น .astype(int)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>เฉลย:</strong></p>
<ol class="arabic simple">
<li><p>เพราะ <code class="docutils literal notranslate"><span class="pre">StockCode</span></code> ไม่ใช่ตัวเลขเท่านั้น แต่มีรหัสที่เป็นตัวอักษรด้วย ดังนั้นจึงแปลงเป็น <code class="docutils literal notranslate"><span class="pre">int</span></code> ไม่ได้อยู่แล้ว ส่วนเหตุผลที่ไม่เก็บเป็น <code class="docutils literal notranslate"><span class="pre">object</span></code> ก็เช่น ใช้ String method ไม่ได้ หรือในแง่ของการใช้งาน การที่มีทั้ง <code class="docutils literal notranslate"><span class="pre">int</span></code> และ <code class="docutils literal notranslate"><span class="pre">string</span></code> ปนกัน ก็อาจสับสนเวลาใช้ เช่น จะใช้ <code class="docutils literal notranslate"><span class="pre">StockCode</span> <span class="pre">==</span> <span class="pre">55555</span></code> กับ <code class="docutils literal notranslate"><span class="pre">StockCode</span> <span class="pre">==</span> <span class="pre">'55555'</span></code> กันแน่ เป็นต้น</p></li>
<li><p>เพราะ <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> มี <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ซึ่ง ตัวแปร <code class="docutils literal notranslate"><span class="pre">int</span></code> ธรรมดาของ <code class="docutils literal notranslate"><span class="pre">Python</span></code> ไม่รองรับ</p></li>
</ol>
</section>
<section id="dataframe-copy">
<h2><span class="section-number">2.9. </span>เกร็ด: การทำซ้ำข้อมูล <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ด้วย <code class="docutils literal notranslate"><span class="pre">.copy()</span></code><a class="headerlink" href="#dataframe-copy" title="Permalink to this heading">#</a></h2>
<p>เนื่องจากในหัวข้อต่อ ๆ ไป จะมีการแก้ไข <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ไปเรื่อย ๆ ดังนั้น จึงขอคัดลอกตัวแปร <code class="docutils literal notranslate"><span class="pre">data</span></code> ไว้อีกฉบับหนึ่งในชื่อ <code class="docutils literal notranslate"><span class="pre">original_data</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>โดยการทดลองต่าง ๆ ให้ใช้ตัวแปร <code class="docutils literal notranslate"><span class="pre">data</span></code> และในกรณีที่ต้องการโหลดข้อมูลต้นฉบับมาใหม่ ให้ใช้คำสั่ง</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>ซึ่งจะเป็นการโหลดต้นฉบับ กลับมาให้ตัวแปร <code class="docutils literal notranslate"><span class="pre">data</span></code></p>
<section id="copy">
<h3><span class="section-number">2.9.1. </span>ทำไมต้องใช้ <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> ?<a class="headerlink" href="#copy" title="Permalink to this heading">#</a></h3>
<p>อย่างไรก็ตาม อาจมีคำถามว่า ทำไมจึงต้องใช้ <code class="docutils literal notranslate"><span class="pre">.copy()</span></code>  เหตุใดไม่เขียนโค้ด ดังนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">data</span>   <span class="c1"># ไม่มี .copy()</span>
</pre></div>
</div>
<p>คำตอบก็คือ การเขียนแบบนี้ จะได้ตัวแปร <code class="docutils literal notranslate"><span class="pre">new_data</span></code> ที่หมายถึงข้อมูลที่เก็บใน RAM ที่เดียวกับของตัวแปร <code class="docutils literal notranslate"><span class="pre">data</span></code> แม้ชื่อจะต่างกัน (หรือพูดง่าย ๆ ว่า <code class="docutils literal notranslate"><span class="pre">new_data</span></code> เป็นชื่อเล่น ของ <code class="docutils literal notranslate"><span class="pre">data</span></code>) ดังนั้น หากมีการแก้ไข <code class="docutils literal notranslate"><span class="pre">data</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">new_data</span></code> ตัวใดตัวหนึ่ง ด้วยคำสั่งของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> บางคำสั่ง อาจทำให้ตัวแปรอีกตัวเปลี่ยนตามด้วย ซึ่งจะไม่ตรงกับจุดประสงค์ของเราที่ต้องการสำรองค่าตัวแปรไว้</p>
<p>เพื่อทำความเข้าใจ ขอให้นึกศึกษา พิจารณา 3 กรณี ต่อไปนี้</p>
<p><strong>กรณีที่ 1</strong> จะเห็นว่า เมื่อไม่ใช้ <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> เมื่อมีการแก้ไข <code class="docutils literal notranslate"><span class="pre">new_data</span></code> กลับทำให้ <code class="docutils literal notranslate"><span class="pre">data</span></code> เปลี่ยนตาม (จำนวนแถวลดลง)</p>
<p><strong>แบบนี้ต้องระวัง!!! อาจส่งผลให้การคำนวณต่อจากนั้นผิดพลาด</strong></p>
<p>เพราะ <code class="docutils literal notranslate"><span class="pre">new_data</span></code> เป็นชื่อเล่นของ <code class="docutils literal notranslate"><span class="pre">data</span></code> ที่หมายถึงข้อมูลที่เก็บไว้ใน RAM ที่เดียวกัน</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># โหลดข้อมูลต้นฉลับ</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">data</span>              <span class="c1"># กำหนดค่าโดยไม่มี .copy()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ก่อน: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">new_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># ใช้ inplace=True (.dropna อยู่ในหัวข้อ Q3.3)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;หลัง: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ก่อน: data.shape=(74802, 10), new_data.shape=(74802, 10)
หลัง: data.shape=(55164, 10), new_data.shape=(55164, 10)
</pre></div>
</div>
</div>
</div>
<p><strong>กรณีที่ 2</strong> จะเห็นว่า เมื่อใช้ <code class="docutils literal notranslate"><span class="pre">copy()</span></code> เมื่อมีการแก้ไข <code class="docutils literal notranslate"><span class="pre">new_data</span></code> ไม่ทำให้ <code class="docutils literal notranslate"><span class="pre">data</span></code> เปลี่ยนตาม</p>
<p><strong>แบบนี้ OK</strong></p>
<p>เพราะ <code class="docutils literal notranslate"><span class="pre">copy()</span></code> ทำให้ <code class="docutils literal notranslate"><span class="pre">new_data</span></code> กับ <code class="docutils literal notranslate"><span class="pre">data</span></code> เก็บข้อมูลใน RAM คนละที่</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>   <span class="c1"># โหลดข้อมูลต้นฉลับ</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>        <span class="c1"># กำหนดค่าโดยมี .copy()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ก่อน: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">new_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># ใช้ inplace=True</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;หลัง: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ก่อน: data.shape=(74802, 10), new_data.shape=(74802, 10)
หลัง: data.shape=(74802, 10), new_data.shape=(55164, 10)
</pre></div>
</div>
</div>
</div>
<p><strong>กรณีที่ 3</strong>  จะเห็นว่า ไม่ใช้ <code class="docutils literal notranslate"><span class="pre">copy()</span></code> เมื่อมีการแก้ไข <code class="docutils literal notranslate"><span class="pre">new_data</span></code> กลับทำให้ <code class="docutils literal notranslate"><span class="pre">data</span></code> เปลี่ยนตาม (จำนวนแถวลดลง)</p>
<p><strong>แบบนี้ก็ OK แต่จะเกิดข้อผิดพลาดภายหลังหากเผลอใช้ <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code></strong></p>
<p>สาเหตุที่แบบนี้ไม่เกิดปัญหา แม้ว่าตอนแรก <code class="docutils literal notranslate"><span class="pre">new_data</span></code> กับ <code class="docutils literal notranslate"><span class="pre">data</span></code> จะหมายถึงข้อมูลใน RAM ที่เดียวกัน แต่คำสั่ง <code class="docutils literal notranslate"><span class="pre">new_data.dropna()</span></code> ให้ค่าที่ RAM ตำแหน่งใหม่ ซึ่งเราก็ไปตั้งชื่อมันว่า <code class="docutils literal notranslate"><span class="pre">new_data</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>    <span class="c1"># โหลดข้อมูลต้นฉลับ</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">data</span>                <span class="c1"># กำหนดค่าโดยไม่มี .copy()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ก่อน: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>   <span class="c1"># ไม่ใช้ inplace=True</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;หลัง: data.shape=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">, new_data.shape=</span><span class="si">{</span><span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ก่อน: data.shape=(74802, 10), new_data.shape=(74802, 10)
หลัง: data.shape=(74802, 10), new_data.shape=(55164, 10)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="q3-missing-value">
<h2><span class="section-number">2.10. </span>Q3 ข้อมูลที่ขาดหาย (Missing value)<a class="headerlink" href="#q3-missing-value" title="Permalink to this heading">#</a></h2>
<p>ข้อมูลที่ขาดหาย ก็คือข้อมูลที่ว่างเปล่าตั้งแต่ในไฟล์ CSV หรือ Excel ซึ่งพออ่านเข้ามาใน <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> จะถูกแทนที่ด้วยค่า <code class="docutils literal notranslate"><span class="pre">NaN</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">&lt;NA&gt;</span></code> (หรือเรียกว่า null) <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/missing_data.html">ดูคู่มือ</a></p>
<p>ข้อมูลขายของออนไลน์ในคาบนี้มีความยากกว่าข้อมูลการให้ทิปในคาบก่อนอยู่มาก ส่วนหนึ่งก็มาจากข้อมูลที่ไม่สมบูรณ์ การตรวจสอบข้อมูลที่ขาดหายไป ดูได้จาก <code class="docutils literal notranslate"><span class="pre">DataFrame.info()</span></code> เหมือนเช่นในคาบผ่านมา</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 74802 entries, 0 to 74801
Data columns (total 10 columns):
 #   Column       Non-Null Count  Dtype         
---  ------       --------------  -----         
 0   index        74802 non-null  int64         
 1   InvoiceNo    74802 non-null  string        
 2   StockCode    74802 non-null  string        
 3   Description  74565 non-null  string        
 4   Quantity     74802 non-null  int64         
 5   InvoiceDate  74802 non-null  datetime64[ns]
 6   UnitPrice    74802 non-null  float64       
 7   CustomerID   55164 non-null  Int64         
 8   Country      74802 non-null  string        
 9   Sheet        74802 non-null  object        
dtypes: Int64(1), datetime64[ns](1), float64(1), int64(2), object(1), string(4)
memory usage: 5.8+ MB
</pre></div>
</div>
</div>
</div>
<p>หรืออาจคำนวณเองได้จากฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">DataFrame.isna()</span></code> ซึ่งจะให้ผลลัพธ์เป็น <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ที่เก็บตัวแปร <code class="docutils literal notranslate"><span class="pre">bool</span></code> ทั้งหมด</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">flags</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># False แปลว่ามีข้อมูล แต่ถ้า True แปลว่า missing value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-11fe144e-3966-450e-973f-33e07ec4151f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39194</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>42562</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>18450</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>70279</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>71717</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-11fe144e-3966-450e-973f-33e07ec4151f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-11fe144e-3966-450e-973f-33e07ec4151f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-11fe144e-3966-450e-973f-33e07ec4151f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-789c93f0-d355-4446-9fcb-2b4c63f0fd11">
  <button class="colab-df-quickchart" onclick="quickchart('df-789c93f0-d355-4446-9fcb-2b4c63f0fd11')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-789c93f0-d355-4446-9fcb-2b4c63f0fd11 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>และเนื่องจาก <code class="docutils literal notranslate"><span class="pre">False</span></code> สามาถแปลงเป็นค่า <code class="docutils literal notranslate"><span class="pre">0</span></code> และ <code class="docutils literal notranslate"><span class="pre">True</span></code> สามารถแปลงเป็นค่า <code class="docutils literal notranslate"><span class="pre">1</span></code> ได้อัตโนมัติ ดังนั้น จึงใช้ฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">DataFrame.sum()</span></code> ในการนับจำนวน missing value ได้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flags</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index              0
InvoiceNo          0
StockCode          0
Description      237
Quantity           0
InvoiceDate        0
UnitPrice          0
CustomerID     19638
Country            0
Sheet              0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>จากรายงาน จะเห็นว่าข้อมูลทั้งหมดมี 74,802 แถว แต่ <code class="docutils literal notranslate"><span class="pre">Description</span></code> มีข้อมูลขาดหายไป 237 ตำแหน่ง ส่วน <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> ขาดหายไป 19638 ตำแหน่ง</p>
<p>หากจะลองสุ่มตรวจดูแถวที่มี <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ก็สามารถทำได้ ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5f9a87f3-5db9-421a-b1f6-80ae3bc4bb82" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>139</th>
      <td>139</td>
      <td>558663</td>
      <td>23574</td>
      <td>&lt;NA&gt;</td>
      <td>100</td>
      <td>2011-07-01 10:44:00</td>
      <td>0.00</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>171</th>
      <td>171</td>
      <td>558680</td>
      <td>20711</td>
      <td>JUMBO BAG TOYS</td>
      <td>1</td>
      <td>2011-07-01 11:19:00</td>
      <td>4.13</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>172</th>
      <td>172</td>
      <td>558680</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-01 11:19:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>173</th>
      <td>173</td>
      <td>558680</td>
      <td>21166</td>
      <td>COOK WITH WINE METAL SIGN</td>
      <td>1</td>
      <td>2011-07-01 11:19:00</td>
      <td>4.13</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>174</th>
      <td>174</td>
      <td>558680</td>
      <td>21175</td>
      <td>GIN + TONIC DIET METAL SIGN</td>
      <td>1</td>
      <td>2011-07-01 11:19:00</td>
      <td>4.96</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5f9a87f3-5db9-421a-b1f6-80ae3bc4bb82')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5f9a87f3-5db9-421a-b1f6-80ae3bc4bb82 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5f9a87f3-5db9-421a-b1f6-80ae3bc4bb82');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-f463413a-1f0c-4037-a019-c300b70f73bd">
  <button class="colab-df-quickchart" onclick="quickchart('df-f463413a-1f0c-4037-a019-c300b70f73bd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-f463413a-1f0c-4037-a019-c300b70f73bd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p><strong>ลองดู:</strong> นอกจากฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">.isna()</span></code> แล้ว ยังมีอีกฟังก์ชันคือ <code class="docutils literal notranslate"><span class="pre">.notna()</span></code> ซึ่งทำงานในลักษณะกันข้าม ขอให้ทดลองด้วยตนเองว่า <code class="docutils literal notranslate"><span class="pre">.notna()</span></code> ใช้แล้วให้ผลอย่างไร</p>
<section id="q3-1-nan-dropna-false">
<h3><span class="section-number">2.10.1. </span>Q3.1 ถ้าไม่อยากมองข้าม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ต้องกำหนด <code class="docutils literal notranslate"><span class="pre">dropna=False</span></code><a class="headerlink" href="#q3-1-nan-dropna-false" title="Permalink to this heading">#</a></h3>
<p>โดย default นั้น ฟังก์ชันบางฟังก์ชันของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> จะมองข้ามค่า <code class="docutils literal notranslate"><span class="pre">NaN</span></code> เช่น ฟังก์ชัน</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Series.value_counts()</span></code> (เนื้อหาคาบที่ผ่านมา)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Series.nunique()</span></code>  (เนื้อหาคาบที่ผ่านมา)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame.groupby()</span></code>  (ยังไม่ได้สอน)</p></li>
</ul>
<p>ดังนั้นจึงเป็นสิ่งที่ควรระวังหากจำเป็นจำต้องสนใจค่า <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ด้วย จะต้องเรียกใช้ โดยกำหนด</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Series.value_counts(dropna=False)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Series.nunique(dropna=False)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataFrame.groupby(...,</span> <span class="pre">dropna=False)</span></code></p></li>
</ul>
<p>และเพื่อเป็นตัวอย่างต่อไป จะขอยกตัวอย่างเฉพาะรายการสินค้า <code class="docutils literal notranslate"><span class="pre">StockCode</span> <span class="pre">==</span> <span class="pre">'21116'</span></code> ซึ่งคือ <code class="docutils literal notranslate"><span class="pre">OWL</span> <span class="pre">DOORSTOP</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doorstop</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;StockCode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;21116&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนแถวเท่ากับ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">doorstop</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว&#39;</span><span class="p">)</span>
<span class="n">doorstop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>จำนวนแถวเท่ากับ 32 แถว
</pre></div>
</div>
<div class="output text_html">
  <div id="df-fe4dc9e1-ac0e-4c07-8650-c4409f660ce2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>172</th>
      <td>172</td>
      <td>558680</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-01 11:19:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3314</th>
      <td>3314</td>
      <td>558888</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>2</td>
      <td>2011-07-04 15:29:00</td>
      <td>4.95</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>5183</th>
      <td>5183</td>
      <td>559052</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-05 16:53:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>7510</th>
      <td>7510</td>
      <td>559163</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-06 16:33:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>8856</th>
      <td>8856</td>
      <td>559337</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-07 16:27:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>18170</th>
      <td>18170</td>
      <td>560078</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-07-14 16:12:00</td>
      <td>4.95</td>
      <td>16040</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>18298</th>
      <td>18298</td>
      <td>560090</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-14 16:46:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>21311</th>
      <td>21311</td>
      <td>560291</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-07-18 10:17:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>25086</th>
      <td>25086</td>
      <td>560603</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-07-20 08:59:00</td>
      <td>4.95</td>
      <td>18180</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>28459</th>
      <td>28459</td>
      <td>560901</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-07-21 17:39:00</td>
      <td>4.95</td>
      <td>12476</td>
      <td>Germany</td>
      <td>July</td>
    </tr>
    <tr>
      <th>31253</th>
      <td>31253</td>
      <td>561093</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>6</td>
      <td>2011-07-25 10:01:00</td>
      <td>4.95</td>
      <td>12540</td>
      <td>Spain</td>
      <td>July</td>
    </tr>
    <tr>
      <th>34832</th>
      <td>34832</td>
      <td>561488</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-07-27 13:51:00</td>
      <td>4.95</td>
      <td>16609</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>40422</th>
      <td>904</td>
      <td>562025</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-01 16:16:00</td>
      <td>4.95</td>
      <td>12828</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>40824</th>
      <td>1306</td>
      <td>562037</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-02 09:34:00</td>
      <td>4.95</td>
      <td>13023</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>45904</th>
      <td>6386</td>
      <td>562519</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-05 12:37:00</td>
      <td>4.95</td>
      <td>16764</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>46975</th>
      <td>7457</td>
      <td>562565</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>2</td>
      <td>2011-08-07 10:45:00</td>
      <td>4.95</td>
      <td>16206</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>48908</th>
      <td>9390</td>
      <td>562717</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-08 15:42:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>51846</th>
      <td>12328</td>
      <td>562955</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>8</td>
      <td>2011-08-11 10:14:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>52785</th>
      <td>13267</td>
      <td>563032</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-11 14:39:00</td>
      <td>4.95</td>
      <td>16076</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>54451</th>
      <td>14933</td>
      <td>563195</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-12 16:36:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>55449</th>
      <td>15931</td>
      <td>563256</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-15 12:07:00</td>
      <td>4.95</td>
      <td>18143</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>57650</th>
      <td>18132</td>
      <td>563549</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>2</td>
      <td>2011-08-17 12:34:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>63872</th>
      <td>24354</td>
      <td>564140</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-23 11:47:00</td>
      <td>4.95</td>
      <td>12621</td>
      <td>Germany</td>
      <td>August</td>
    </tr>
    <tr>
      <th>64935</th>
      <td>25417</td>
      <td>564203</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>12</td>
      <td>2011-08-24 08:49:00</td>
      <td>4.95</td>
      <td>18061</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>65010</th>
      <td>25492</td>
      <td>564221</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>5</td>
      <td>2011-08-24 09:36:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>65216</th>
      <td>25698</td>
      <td>564223</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>3</td>
      <td>2011-08-24 09:46:00</td>
      <td>4.95</td>
      <td>13013</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>66699</th>
      <td>27181</td>
      <td>564359</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>4</td>
      <td>2011-08-24 16:02:00</td>
      <td>4.95</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>67642</th>
      <td>28124</td>
      <td>564516</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>2</td>
      <td>2011-08-25 14:45:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>67747</th>
      <td>28229</td>
      <td>564530</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-25 14:57:00</td>
      <td>0.00</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>71205</th>
      <td>31687</td>
      <td>564758</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-30 10:39:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>71792</th>
      <td>32274</td>
      <td>564817</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>1</td>
      <td>2011-08-30 12:02:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>73769</th>
      <td>34251</td>
      <td>564857</td>
      <td>21116</td>
      <td>OWL DOORSTOP</td>
      <td>6</td>
      <td>2011-08-31 09:23:00</td>
      <td>8.29</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fe4dc9e1-ac0e-4c07-8650-c4409f660ce2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fe4dc9e1-ac0e-4c07-8650-c4409f660ce2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fe4dc9e1-ac0e-4c07-8650-c4409f660ce2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-dbf544f3-673c-447a-a6bb-4b444729bc9f">
  <button class="colab-df-quickchart" onclick="quickchart('df-dbf544f3-673c-447a-a6bb-4b444729bc9f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-dbf544f3-673c-447a-a6bb-4b444729bc9f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doorstop</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>  <span class="c1"># มองข้าม NaN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14056    2
16040    1
18180    1
12476    1
12540    1
16609    1
12828    1
13023    1
16764    1
16206    1
16076    1
18143    1
12621    1
18061    1
13013    1
Name: CustomerID, dtype: Int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">doorstop</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># จะเห็นว่านัง NaN ได้ 16 ค่า</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;NA&gt;     16
14056     2
16040     1
18180     1
12476     1
12540     1
16609     1
12828     1
13023     1
16764     1
16206     1
16076     1
18143     1
12621     1
18061     1
13013     1
Name: CustomerID, dtype: Int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="q3-2">
<h3><span class="section-number">2.10.2. </span>Q3.2 เติมข้อมูลที่ขาดหายด้วยค่าคงที่<a class="headerlink" href="#q3-2" title="Permalink to this heading">#</a></h3>
<p>Missing value สามารถเติมได้โดยใช้คำสั่ง <code class="docutils literal notranslate"><span class="pre">Series.fillna()</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">DataFrame.fillna()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;ไม่ทราบชื่อ&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ไม่ทราบชื่อ&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b5dec891-eb1b-47d7-beee-964173339b2e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>139</th>
      <td>139</td>
      <td>558663</td>
      <td>23574</td>
      <td>ไม่ทราบชื่อ</td>
      <td>100</td>
      <td>2011-07-01 10:44:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>870</th>
      <td>870</td>
      <td>558724</td>
      <td>35966</td>
      <td>ไม่ทราบชื่อ</td>
      <td>14</td>
      <td>2011-07-01 14:30:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>879</th>
      <td>879</td>
      <td>558728</td>
      <td>20826</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-1</td>
      <td>2011-07-01 14:50:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>950</th>
      <td>950</td>
      <td>558732</td>
      <td>47341A</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-1</td>
      <td>2011-07-01 14:55:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>998</th>
      <td>998</td>
      <td>558741</td>
      <td>37444C</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-1</td>
      <td>2011-07-01 15:52:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>74718</th>
      <td>35200</td>
      <td>565063</td>
      <td>21175</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-18</td>
      <td>2011-08-31 17:15:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>74790</th>
      <td>35272</td>
      <td>565069</td>
      <td>20665</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-49</td>
      <td>2011-08-31 17:18:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>74791</th>
      <td>35273</td>
      <td>565070</td>
      <td>85032D</td>
      <td>ไม่ทราบชื่อ</td>
      <td>171</td>
      <td>2011-08-31 17:18:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>74792</th>
      <td>35274</td>
      <td>565071</td>
      <td>84754</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-242</td>
      <td>2011-08-31 17:21:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
    <tr>
      <th>74793</th>
      <td>35275</td>
      <td>565072</td>
      <td>21820</td>
      <td>ไม่ทราบชื่อ</td>
      <td>-210</td>
      <td>2011-08-31 17:22:00</td>
      <td>0.0</td>
      <td>&lt;NA&gt;</td>
      <td>United Kingdom</td>
      <td>August</td>
    </tr>
  </tbody>
</table>
<p>237 rows × 10 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b5dec891-eb1b-47d7-beee-964173339b2e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b5dec891-eb1b-47d7-beee-964173339b2e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b5dec891-eb1b-47d7-beee-964173339b2e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7e17a83e-2cd6-4d80-8206-fc59a763e71c">
  <button class="colab-df-quickchart" onclick="quickchart('df-7e17a83e-2cd6-4d80-8206-fc59a763e71c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7e17a83e-2cd6-4d80-8206-fc59a763e71c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="q3-3-nan">
<h3><span class="section-number">2.10.3. </span>Q3.3 ไม่รู้จะเติม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ด้วยอะไร ก็ลบซะเลย<a class="headerlink" href="#q3-3-nan" title="Permalink to this heading">#</a></h3>
<p>ก่อนอื่น เนื่องจาก <code class="docutils literal notranslate"><span class="pre">data</span></code> ถูกเปลี่ยนค่า <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ไปในข้อ Q3.2 ดังนั้น จึงขอโหลดต้นฉบับกลับมา</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>สามารถใช้คำสั่ง <code class="docutils literal notranslate"><span class="pre">DataFrame.dropna()</span></code> ในการลบแถว ซึ่งมีพารามิเตอร์ ได้แก่</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">how='any'</span></code> หมายถึง ถ้ามี <code class="docutils literal notranslate"><span class="pre">NaN</span></code> แค่ตัวเดียวในแถวนั้น ก็ให้ลบทั้งแถว หรือ <code class="docutils literal notranslate"><span class="pre">how='all'</span></code> หมายถึง ต้องมี <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ทุกคอลัมน์ จึงจะลบได้ โดย <code class="docutils literal notranslate"><span class="pre">how='any'</span></code> เป็นค่า default</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subset=</span></code> รายการของชื่อคอลัมน์ที่จะให้พิจารณาว่ามี <code class="docutils literal notranslate"><span class="pre">NaN</span></code> หรือไม่ โดย <code class="docutils literal notranslate"><span class="pre">how</span></code>จะพิจารณาเฉพาะคอลัมน์ที่ระบุไว้ใน <code class="docutils literal notranslate"><span class="pre">subset</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis=0</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">axis=1</span></code></p>
<ul>
<li><p>หากต้องการพิจารณา <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> เป็นรายแถว ให้กำหนด <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> (default)</p></li>
<li><p>หากต้องการพิจารณา <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> เป็นรายคอลัมน์ ให้กำหนด <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> (ซึ่งกรณีนี้ <code class="docutils literal notranslate"><span class="pre">how=</span></code> จะพิจารณา <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ของคอลัมน์หนึ่ง ๆ)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">inplace=False</span></code> หมายถึงให้เขียนทับต้นฉบับหรือไม่</p></li>
</ul>
<p>ขอให้นักศึกษาพิจารณาเปรียบเทียบการใช้งาน จากตัวอย่างต่อไปนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนแถว </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว (ก่อน dropna)&#39;</span><span class="p">)</span>
<span class="n">no_nan</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนแถวที่เหลือ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">no_nan</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว (หลัง dropna ด้วย how=any)&#39;</span><span class="p">)</span>
<span class="n">no_nan</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># แถวที่มี NaN ตัวเดียวขึ้นไป ถูกลบทั้งหมด</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>จำนวนแถว 74802 แถว (ก่อน dropna)
จำนวนแถวที่เหลือ 55164 แถว (หลัง dropna ด้วย how=any)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index          0
InvoiceNo      0
StockCode      0
Description    0
Quantity       0
InvoiceDate    0
UnitPrice      0
CustomerID     0
Country        0
Sheet          0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนแถว </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว (ก่อน dropna)&#39;</span><span class="p">)</span>
<span class="n">no_nan</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Description&#39;</span><span class="p">,</span><span class="s1">&#39;Quantity&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนแถวที่เหลือ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">no_nan</span><span class="p">)</span><span class="si">}</span><span class="s1"> แถว (หลัง dropna ด้วย how=any, subset=[Description, Quantity])&#39;</span><span class="p">)</span>
<span class="n">no_nan</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># แถวที่คอลัมน์ Description และ Quantity มี NaN ตั้งแต่ 1 ตัวขึ้นไป จะถูกลบทั้งหมด</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>จำนวนแถว 74802 แถว (ก่อน dropna)
จำนวนแถวที่เหลือ 74565 แถว (หลัง dropna ด้วย how=any, subset=[Description, Quantity])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index              0
InvoiceNo          0
StockCode          0
Description        0
Quantity           0
InvoiceDate        0
UnitPrice          0
CustomerID     19401
Country            0
Sheet              0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนคอลัมน์ </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> คอลัมน์ (ก่อน dropna)&#39;</span><span class="p">)</span>
<span class="n">no_nan</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;จำนวนคอลัมน์ที่เหลือ </span><span class="si">{</span><span class="n">no_nan</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> คอลัมน์ (หลัง dropna ด้วย how=any)&#39;</span><span class="p">)</span>
<span class="n">no_nan</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># คอลัมน์ที่มี NaN ตัวเดียวขึ้นไป ถูกลบทั้งหมด (CustomerID กับ Description ถูกลบไป)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>จำนวนคอลัมน์ 10 คอลัมน์ (ก่อน dropna)
จำนวนคอลัมน์ที่เหลือ 8 คอลัมน์ (หลัง dropna ด้วย how=any)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>index          0
InvoiceNo      0
StockCode      0
Quantity       0
InvoiceDate    0
UnitPrice      0
Country        0
Sheet          0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="q4-groupby-and-aggregation">
<h2><span class="section-number">2.11. </span>Q4 Groupby and Aggregation<a class="headerlink" href="#q4-groupby-and-aggregation" title="Permalink to this heading">#</a></h2>
<p>หากต้องการแบ่งส่วนของตารางเป็นกลุ่มย่อย ๆ ตามค่าของคอลัมน์ ๆ หนึ่ง (หรืออาจหลายคอลัมน์) สามารถทำได้ง่ายโดยใช้ฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">DataFrame.groupby()</span></code> <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">ดูคู่มือ</a> และสามารถคำนวณค่าสถิติภาพรวมของแต่ละกลุ่มย่อย ด้วยการทำ aggregration (<code class="docutils literal notranslate"><span class="pre">.agg()</span></code>)</p>
<p>ยกตัวอย่างเช่น จากข้อมูล <code class="docutils literal notranslate"><span class="pre">data</span></code> ที่มี หากต้องการแบ่งกลุ่มย่อยตามค่าของคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> จะทำได้ ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inv_group</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7e23477f4ca0&gt;
</pre></div>
</div>
</div>
</div>
<p>ตัวแปร <code class="docutils literal notranslate"><span class="pre">inv_group</span></code> ที่ได้เป็นชนิดข้อมูล <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> ของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code></p>
<p>การนำกลุ่มที่แบ่งขึ้นไปใช้ประโยชนในเบื้องต้น ได้แก่</p>
<section id="q4-1">
<h3><span class="section-number">2.11.1. </span>Q4.1 จะเข้าถึงกลุ่มย่อยได้อย่างไร<a class="headerlink" href="#q4-1" title="Permalink to this heading">#</a></h3>
<p>คำตอบคือ การเข้าได้โดยใช้คำสั่งดังนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;ค่า InvoiceNo ที่ต้องการ&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>เช่น จะเข้าถึงกลุ่มที่ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> มีค่า <code class="docutils literal notranslate"><span class="pre">'558888'</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;558888&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1eb6ad43-c2d7-4650-ae2d-05cefd105689" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>InvoiceDate</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3253</th>
      <td>3253</td>
      <td>558888</td>
      <td>22902</td>
      <td>TOTE BAG I LOVE LONDON</td>
      <td>2</td>
      <td>2011-07-04 15:29:00</td>
      <td>2.10</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3254</th>
      <td>3254</td>
      <td>558888</td>
      <td>21577</td>
      <td>SAVE THE PLANET COTTON TOTE BAG</td>
      <td>3</td>
      <td>2011-07-04 15:29:00</td>
      <td>2.25</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3255</th>
      <td>3255</td>
      <td>558888</td>
      <td>23050</td>
      <td>RECYCLED ACAPULCO MAT GREEN</td>
      <td>5</td>
      <td>2011-07-04 15:29:00</td>
      <td>8.25</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3256</th>
      <td>3256</td>
      <td>558888</td>
      <td>23049</td>
      <td>RECYCLED ACAPULCO MAT RED</td>
      <td>3</td>
      <td>2011-07-04 15:29:00</td>
      <td>8.25</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3257</th>
      <td>3257</td>
      <td>558888</td>
      <td>23052</td>
      <td>RECYCLED ACAPULCO MAT TURQUOISE</td>
      <td>5</td>
      <td>2011-07-04 15:29:00</td>
      <td>8.25</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3335</th>
      <td>3335</td>
      <td>558888</td>
      <td>21888</td>
      <td>BINGO SET</td>
      <td>1</td>
      <td>2011-07-04 15:29:00</td>
      <td>3.75</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3336</th>
      <td>3336</td>
      <td>558888</td>
      <td>23207</td>
      <td>LUNCH BAG ALPHABET DESIGN</td>
      <td>6</td>
      <td>2011-07-04 15:29:00</td>
      <td>1.65</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3337</th>
      <td>3337</td>
      <td>558888</td>
      <td>23205</td>
      <td>CHARLOTTE BAG VINTAGE ALPHABET</td>
      <td>1</td>
      <td>2011-07-04 15:29:00</td>
      <td>0.85</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3338</th>
      <td>3338</td>
      <td>558888</td>
      <td>21912</td>
      <td>VINTAGE SNAKES &amp; LADDERS</td>
      <td>1</td>
      <td>2011-07-04 15:29:00</td>
      <td>3.75</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
    <tr>
      <th>3339</th>
      <td>3339</td>
      <td>558888</td>
      <td>22029</td>
      <td>SPACEBOY BIRTHDAY CARD</td>
      <td>12</td>
      <td>2011-07-04 15:29:00</td>
      <td>0.42</td>
      <td>14056</td>
      <td>United Kingdom</td>
      <td>July</td>
    </tr>
  </tbody>
</table>
<p>87 rows × 10 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1eb6ad43-c2d7-4650-ae2d-05cefd105689')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1eb6ad43-c2d7-4650-ae2d-05cefd105689 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1eb6ad43-c2d7-4650-ae2d-05cefd105689');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ceb3571e-f6d7-4fb1-9b21-f0fc0c893f73">
  <button class="colab-df-quickchart" onclick="quickchart('df-ceb3571e-f6d7-4fb1-9b21-f0fc0c893f73')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ceb3571e-f6d7-4fb1-9b21-f0fc0c893f73 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>ซึ่งจะพบว่าตารางมี 87 แถว และคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> มีค่า <code class="docutils literal notranslate"><span class="pre">'558888'</span></code> เหมือนกันหมด</p>
</section>
<section id="q4-2">
<h3><span class="section-number">2.11.2. </span>Q4.2 การทำข้อมูลภาพรวมจากกลุ่มย่อย<a class="headerlink" href="#q4-2" title="Permalink to this heading">#</a></h3>
<p>การยุบคอลัมน์ในกลุ่มย่อยแต่ละกลุ่มให้เหลือเพียงค่าเดียว เช่น การหาค่าเฉลี่ย ค่าสูงสุด หรือจำนวนแถวของคอลัมน์ เป็นต้น เรียกว่าการทำ aggregration ซึ่งสามารถทำโดยใช้คำสั่ง</p>
<p><code class="docutils literal notranslate"><span class="pre">group.sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">group.min()</span></code> , <code class="docutils literal notranslate"><span class="pre">group.max()</span></code>, …. ฯลฯ หรือ <code class="docutils literal notranslate"><span class="pre">group.agg(['sum','min','max',</span> <span class="pre">...])</span></code></p>
<p>ซึ่งเป็นคำสั่งเดียวกับที่ได้ศึกษาในคาบที่ผ่านมา  (แต่เป็นคาบนั้นเป็นการหาค่าสถิติของทั้งตาราง)
ยกตัวอย่างเช่น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># กำหนด numeric_only=True เพื่อที่จะคำนวณ sum เฉพาะคอลัมน์ที่เป็นตัวเลข</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6be4baa7-f4f1-4958-917f-74408c9ca166" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Quantity</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
    </tr>
    <tr>
      <th>InvoiceNo</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>558638</th>
      <td>23</td>
      <td>50</td>
      <td>12.75</td>
      <td>16317</td>
    </tr>
    <tr>
      <th>558639</th>
      <td>36</td>
      <td>20</td>
      <td>7.95</td>
      <td>13492</td>
    </tr>
    <tr>
      <th>558640</th>
      <td>44</td>
      <td>25</td>
      <td>50.00</td>
      <td>14911</td>
    </tr>
    <tr>
      <th>558641</th>
      <td>73</td>
      <td>24</td>
      <td>10.95</td>
      <td>17865</td>
    </tr>
    <tr>
      <th>558642</th>
      <td>94</td>
      <td>32</td>
      <td>12.75</td>
      <td>17667</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C565044</th>
      <td>35163</td>
      <td>-113</td>
      <td>7.65</td>
      <td>12931</td>
    </tr>
    <tr>
      <th>C565050</th>
      <td>35172</td>
      <td>-1</td>
      <td>4.95</td>
      <td>12381</td>
    </tr>
    <tr>
      <th>C565075</th>
      <td>35277</td>
      <td>-1</td>
      <td>38.39</td>
      <td>13408</td>
    </tr>
    <tr>
      <th>C565077</th>
      <td>35282</td>
      <td>-1</td>
      <td>4.15</td>
      <td>17451</td>
    </tr>
    <tr>
      <th>C565078</th>
      <td>35283</td>
      <td>-1</td>
      <td>57.60</td>
      <td>16422</td>
    </tr>
  </tbody>
</table>
<p>3664 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6be4baa7-f4f1-4958-917f-74408c9ca166')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6be4baa7-f4f1-4958-917f-74408c9ca166 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6be4baa7-f4f1-4958-917f-74408c9ca166');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-698e49dc-8f97-49ac-9973-4c306b6ddf47">
  <button class="colab-df-quickchart" onclick="quickchart('df-698e49dc-8f97-49ac-9973-4c306b6ddf47')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-698e49dc-8f97-49ac-9973-4c306b6ddf47 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>จะเห็นว่า ผลลัพธ์ของ aggregration ด้วย <code class="docutils literal notranslate"><span class="pre">.max()</span></code> นั้น จะได้ <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> (หรืออาจเป็น <code class="docutils literal notranslate"><span class="pre">Series</span></code> กรณีข้อมูลมีคอลัมน์เดียว) ที่แต่ละแถวแสดงค่าสูงสุดของแต่ละกลุ่ม</p>
<p>ทั้งนี้ สามารถเลือกคอลัมน์ที่ต้องการทำ aggregration ได้เหมือนกับการเข้าถึงคอลัมน์ของ <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ดังเช่น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="p">[[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">,</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  <span class="c1"># สามารถเลือกเฉพาะคอลัมน์ได้</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-be257651-94c8-4702-a5ff-1efeaebfa614" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UnitPrice</th>
      <th>Quantity</th>
    </tr>
    <tr>
      <th>InvoiceNo</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>558638</th>
      <td>12.75</td>
      <td>50</td>
    </tr>
    <tr>
      <th>558639</th>
      <td>7.95</td>
      <td>20</td>
    </tr>
    <tr>
      <th>558640</th>
      <td>50.00</td>
      <td>25</td>
    </tr>
    <tr>
      <th>558641</th>
      <td>10.95</td>
      <td>24</td>
    </tr>
    <tr>
      <th>558642</th>
      <td>12.75</td>
      <td>32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C565044</th>
      <td>7.65</td>
      <td>-113</td>
    </tr>
    <tr>
      <th>C565050</th>
      <td>4.95</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>C565075</th>
      <td>38.39</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>C565077</th>
      <td>4.15</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>C565078</th>
      <td>57.60</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>3664 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-be257651-94c8-4702-a5ff-1efeaebfa614')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-be257651-94c8-4702-a5ff-1efeaebfa614 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-be257651-94c8-4702-a5ff-1efeaebfa614');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d2f0b56b-7c2b-430a-8150-09c4fc928129">
  <button class="colab-df-quickchart" onclick="quickchart('df-d2f0b56b-7c2b-430a-8150-09c4fc928129')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d2f0b56b-7c2b-430a-8150-09c4fc928129 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="p">[[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">,</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5c52e38f-be48-4fdf-9e6b-d75460289c96" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">UnitPrice</th>
      <th colspan="2" halign="left">Quantity</th>
    </tr>
    <tr>
      <th></th>
      <th>max</th>
      <th>min</th>
      <th>max</th>
      <th>min</th>
    </tr>
    <tr>
      <th>InvoiceNo</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>558638</th>
      <td>12.75</td>
      <td>0.42</td>
      <td>50</td>
      <td>2</td>
    </tr>
    <tr>
      <th>558639</th>
      <td>7.95</td>
      <td>1.65</td>
      <td>20</td>
      <td>2</td>
    </tr>
    <tr>
      <th>558640</th>
      <td>50.00</td>
      <td>0.42</td>
      <td>25</td>
      <td>1</td>
    </tr>
    <tr>
      <th>558641</th>
      <td>10.95</td>
      <td>0.55</td>
      <td>24</td>
      <td>2</td>
    </tr>
    <tr>
      <th>558642</th>
      <td>12.75</td>
      <td>0.42</td>
      <td>32</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C565044</th>
      <td>7.65</td>
      <td>1.27</td>
      <td>-113</td>
      <td>-318</td>
    </tr>
    <tr>
      <th>C565050</th>
      <td>4.95</td>
      <td>1.25</td>
      <td>-1</td>
      <td>-12</td>
    </tr>
    <tr>
      <th>C565075</th>
      <td>38.39</td>
      <td>36.30</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>C565077</th>
      <td>4.15</td>
      <td>1.45</td>
      <td>-1</td>
      <td>-12</td>
    </tr>
    <tr>
      <th>C565078</th>
      <td>57.60</td>
      <td>57.60</td>
      <td>-1</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>3664 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c52e38f-be48-4fdf-9e6b-d75460289c96')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c52e38f-be48-4fdf-9e6b-d75460289c96 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c52e38f-be48-4fdf-9e6b-d75460289c96');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-791011cf-21fb-4370-b7d0-9156a83489ae">
  <button class="colab-df-quickchart" onclick="quickchart('df-791011cf-21fb-4370-b7d0-9156a83489ae')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-791011cf-21fb-4370-b7d0-9156a83489ae button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="q4-3-group">
<h3><span class="section-number">2.11.3. </span>Q4.3 จะทราบได้อย่างไรว่า <code class="docutils literal notranslate"><span class="pre">group</span></code> ที่ได้มีกี่กลุ่ม อะไรบ้าง<a class="headerlink" href="#q4-3-group" title="Permalink to this heading">#</a></h3>
<p>คำตอบคือ สามารถนับจำนวนกลุ่มโดยใช้ <code class="docutils literal notranslate"><span class="pre">.ngroups</span></code> และสามารถเข้าถึงชื่อกลุ่มทั้งหมดได้จาก <code class="docutils literal notranslate"><span class="pre">.groups.keys()</span></code> ดังตัวอย่างต่อไปนี้</p>
<p><strong>1) นับจำนวนกลุ่ม</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="o">.</span><span class="n">ngroups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3664
</pre></div>
</div>
</div>
</div>
<p>จะเห็นว่ามีทั้งหมด 3664 กลุ่ม ซึ่งตรวจสอบด้วยคำสั่ง</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3664
</pre></div>
</div>
</div>
</div>
<p><strong>2) รายชื่อกลุ่มทั้งหมดที่เป็นไปได้</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inv_group</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>   <span class="c1"># ให้นักศึกษาลองใช้ดู</span>
</pre></div>
</div>
</section>
</section>
<section id="q5-datetime">
<h2><span class="section-number">2.12. </span>Q5 เกี่ยวกับข้อมูลวันที่ (<code class="docutils literal notranslate"><span class="pre">datetime</span></code>)<a class="headerlink" href="#q5-datetime" title="Permalink to this heading">#</a></h2>
<section id="q5-1-string-datetime">
<h3><span class="section-number">2.12.1. </span>Q5.1 การแปลง <code class="docutils literal notranslate"><span class="pre">string</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">datetime</span></code><a class="headerlink" href="#q5-1-string-datetime" title="Permalink to this heading">#</a></h3>
<p>สมมติว่ามี <code class="docutils literal notranslate"><span class="pre">string</span></code> ที่เก็บค่าวันที่ ดังนี้</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start_date</span> <span class="pre">=</span> <span class="pre">'20/12/2023'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end_date</span> <span class="pre">=</span> <span class="pre">'25/12/2023'</span></code></p></li>
</ul>
<p>เราคาดหวังว่า เมื่อเปรียบเทียบ <code class="docutils literal notranslate"><span class="pre">start_date</span> <span class="pre">&lt;</span> <span class="pre">end_date</span></code> แล้วจะต้องได้ค่า <code class="docutils literal notranslate"><span class="pre">True</span></code> แต่ทว่าการกระทำเช่นนี้ไม่สามารถทำได้โดยง่ายระหว่างตัวแปรประเภท <code class="docutils literal notranslate"><span class="pre">string</span></code></p>
<p>ด้วยเหตุนี้ จึงเกิดตัวแปรประเภท <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ขึ้น ซึ่งวิธีสร้างตัวแปร <code class="docutils literal notranslate"><span class="pre">datetime</span></code> วิธีหนึ่ง ก็คือการแปลงจาก <code class="docutils literal notranslate"><span class="pre">string</span></code> ให้เป็น <code class="docutils literal notranslate"><span class="pre">datetime</span></code> โดยใช้คำสั่งต่อไปนี้</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">สตริงที่ต้องการแปลง</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">รูปแบบของวันเวลา</span><span class="p">)</span>
</pre></div>
</div>
<p>ยกตัวอย่างเช่น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">birth_time</span> <span class="o">=</span> <span class="s1">&#39;19-Mar-98 15:34:56&#39;</span>  <span class="c1"># = 19 March 1998 15:34:56</span>
<span class="n">birth_time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">birth_time</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y %H:%M:%S&#39;</span><span class="p">)</span>
<span class="n">birth_time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;1998-03-19 15:34:56&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;20/12/2023&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;December 25, 2023&#39;</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%B </span><span class="si">%d</span><span class="s1">, %Y&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start_date</span> <span class="o">&lt;</span> <span class="n">end_date</span><span class="p">)</span> <span class="c1"># เปรียบเทียบวันเวลาได้</span>
<span class="nb">print</span><span class="p">(</span><span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">end_date</span><span class="p">)</span> <span class="c1"># เปรียบเทียบวันเวลาได้</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-12-20 00:00:00
2023-12-25 00:00:00
True
False
</pre></div>
</div>
</div>
</div>
<p>ซึ่งรูปแบบของวันเวลา ดูได้ตาม<a class="reference external" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior">คู่มือ</a>ฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">strftime()</span></code> ของภาษา <code class="docutils literal notranslate"><span class="pre">Python</span></code> ที่ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> เรียกใช้งาน</p>
<p>สำหรับรูปแบบของวันเวลาที่แสดงในตัวอย่าง เครื่องหมาย <code class="docutils literal notranslate"><span class="pre">%</span></code> แต่ละตัวมีความหมาย ดังตาราง</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>คำสั่ง</p></th>
<th class="head text-left"><p>ความหมาย</p></th>
<th class="head text-left"><p>ตัวอย่าง</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%d</span></code></p></td>
<td class="text-left"><p>วันที่ 2 หลัก</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">01,</span> <span class="pre">02,</span> <span class="pre">…,</span> <span class="pre">31</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%m</span></code></p></td>
<td class="text-left"><p>เลขเดือน 2 หลัก</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">01,</span> <span class="pre">02,</span> <span class="pre">…,</span> <span class="pre">12</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%b</span></code></p></td>
<td class="text-left"><p>ชื่อเดือนย่อ</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">Jan,</span> <span class="pre">Feb,</span> <span class="pre">…,</span> <span class="pre">Dec</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%B</span></code></p></td>
<td class="text-left"><p>ชื่อเดือนเต็ม</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">January,</span> <span class="pre">February,</span> <span class="pre">…,</span> <span class="pre">December</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%y</span></code></p></td>
<td class="text-left"><p>เลขปี 2 หลักท้าย (ละเลขศตวรรษ)</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">00,</span> <span class="pre">01,</span> <span class="pre">…,</span> <span class="pre">99</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%Y</span></code></p></td>
<td class="text-left"><p>เลขปี 4 หลัก</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">0001,</span> <span class="pre">0002,</span> <span class="pre">…,</span> <span class="pre">9999</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%H</span></code></p></td>
<td class="text-left"><p>ชั่วโมง</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">00,</span> <span class="pre">01,</span> <span class="pre">…,</span> <span class="pre">23</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%M</span></code></p></td>
<td class="text-left"><p>นาที</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">00,</span> <span class="pre">01,</span> <span class="pre">…,</span> <span class="pre">59</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><code class="docutils literal notranslate"><span class="pre">%S</span></code></p></td>
<td class="text-left"><p>วินาที</p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">00,</span> <span class="pre">01,</span> <span class="pre">…,</span> <span class="pre">59</span></code></p></td>
</tr>
</tbody>
</table>
<p>หากตัวแปรเป็นประเภท <code class="docutils literal notranslate"><span class="pre">datetime</span></code> แล้ว ก็จะสามารถเข้าถึงค่าวัน เดือน ปี ชั่วโมง นาที วินาที สัปดาห์ที่ ได้ ดังตัวอย่างนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">birth_time</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Year =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Month =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Day =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Week =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">week</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hour =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minute =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Second =&#39;</span><span class="p">,</span> <span class="n">birth_time</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1998-03-19 15:34:56
Year = 1998
Month = 3
Day = 19
Week = 12
Hour = 15
Minute = 34
Second = 56
</pre></div>
</div>
</div>
</div>
</section>
<section id="q5-2">
<h3><span class="section-number">2.12.2. </span>Q5.2 การคำนวณส่วนต่างของเวลา<a class="headerlink" href="#q5-2" title="Permalink to this heading">#</a></h3>
<p>หากมีตัวแปร <code class="docutils literal notranslate"><span class="pre">datetime</span></code> 2 ตัว จะสามารถคำนวณความแตกต่างระหว่างวันเวลาได้ ดังเช่น</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;start = </span><span class="si">{</span><span class="n">start_date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;end   = </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">difference</span> <span class="o">=</span> <span class="n">end_date</span> <span class="o">-</span> <span class="n">start_date</span>
<span class="nb">print</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>start = 2023-12-20 00:00:00
end   = 2023-12-25 00:00:00
5 days 00:00:00
</pre></div>
</div>
</div>
</div>
<p>โดยผลลัพธ์ที่ได้ในตัวแปร <code class="docutils literal notranslate"><span class="pre">difference</span></code> จะได้ตัวแปรประเภท <code class="docutils literal notranslate"><span class="pre">timedelta</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">difference</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas._libs.tslibs.timedeltas.Timedelta&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>ซึ่งส่วนต่าง 5 วัน ที่คำนวณได้ สามารถถึงค่าจำนวนวันออกมาได้ด้วย <code class="docutils literal notranslate"><span class="pre">.days</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">difference</span><span class="o">.</span><span class="n">days</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
</section>
<section id="q5-3-datetime-series-dataframe">
<h3><span class="section-number">2.12.3. </span>Q5.3 <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ใน <code class="docutils literal notranslate"><span class="pre">Series/DataFrame</span></code><a class="headerlink" href="#q5-3-datetime-series-dataframe" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> สามารถแปลงให้เป็น <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ได้ โดยใช้ฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code> เช่นกัน แต่สำหรับข้อมูลร้านขายของออนไลน์ในคาบนี้ คอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> ถูกแปลงเป็นประเภท <code class="docutils literal notranslate"><span class="pre">datetime</span></code> โดยอัตโนมัติอยู่แล้ว ดังนั้นจึงไม่ต้องทำอะไรเพิ่มเติม</p>
<p>ดังนั้นในส่วนนี้ จะยกตัวอย่างของการดึงค่าจากตัวแปร <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ที่เป็นเลขสัปดาห์ที่, เลขเดือน, และเลขชั่วโมง ไปสร้างเป็น 3 คอลัมน์ใหม่</p>
<section id="id6">
<h4><span class="section-number">2.12.3.1. </span>เพิ่มคอลัมน์เลขเดือน<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MonthNo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h4><span class="section-number">2.12.3.2. </span>เพิ่มคอลัมน์เลขสัปดาห์<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;WeekNo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">week</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-306-bff456602fe4&gt;:1: FutureWarning:

Series.dt.weekofyear and Series.dt.week have been deprecated. Please use Series.dt.isocalendar().week instead.
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4><span class="section-number">2.12.3.3. </span>เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อน 12.00 น. หรือไม่<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;BeforeNoon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4><span class="section-number">2.12.3.4. </span>เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อนวันคริสต์มาสปี 2011 กี่วัน<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmas</span> <span class="o">=</span> <span class="s1">&#39;2011-12-25&#39;</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;DaysToXmas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">xmas</span><span class="p">)</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">days</span>  <span class="c1"># เอาเฉพาะจำนวนวัน</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="invoicedate">
<h4><span class="section-number">2.12.3.5. </span>ตอบคำถามว่า <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> แรกสุดและล่าสุดในคือวันและเวลาใด<a class="headerlink" href="#invoicedate" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>min   2011-07-01 08:16:00
max   2011-08-31 17:45:00
Name: InvoiceDate, dtype: datetime64[ns]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="q6">
<h2><span class="section-number">2.13. </span>Q6 การรายงานข้อมูลเป็นรายลูกค้า<a class="headerlink" href="#q6" title="Permalink to this heading">#</a></h2>
<p>จากข้อมูลที่มี ในช่วง 2 เดือน จะตอบคำถามต่อไปนี้</p>
<ol class="arabic simple">
<li><p>ลูกค้าแต่ละคน มีจำนวน Invoice เกิดขึ้นกี่ Invoice และเกี่ยวข้องกับสินค้าทั้งหมดกี่ชนิด (<code class="docutils literal notranslate"><span class="pre">StockCode</span></code>)</p></li>
<li><p>ลูกค้าแต่ละคนเข้ามาแรกสุดและล่าสุดเมื่อใด (จากข้อมูลทั้งหมดที่มี)</p></li>
<li><p>ยอดซื้อรวมของลูกค้าแต่ละคน</p></li>
</ol>
<p>ซึ่งทำได้ 2 วิธี</p>
<section id="id10">
<h3><span class="section-number">2.13.1. </span><strong>วิธีที่ 1</strong> ทำ 1,2,และ 3 แล้วค่อยนำมารวมกัน<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<section id="invoice-invoice-stockcode">
<h4><span class="section-number">2.13.1.1. </span>1. ลูกค้าแต่ละคน มีจำนวน Invoice เกิดขึ้นกี่ Invoice และเกี่ยวข้องกับสินค้าทั้งหมดกี่ชนิด (<code class="docutils literal notranslate"><span class="pre">StockCode</span></code>)<a class="headerlink" href="#invoice-invoice-stockcode" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">customer_invoiceno</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">)[[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">,</span><span class="s1">&#39;StockCode&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_invoiceno</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1540, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h4><span class="section-number">2.13.1.2. </span>2. ลูกค้าแต่ละคนเข้ามาแรกสุดและล่าสุดเมื่อใด (จากข้อมูลทั้งหมดที่มี)<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">customer_duration</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">)[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">customer_duration</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1540, 2)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h4><span class="section-number">2.13.1.3. </span>3. ยอดซื้อรวมของลูกค้าแต่ละคน<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h4>
<p>ก่อนอื่น ต้องคำนวณยอดรวมของแต่ละรายการก่อน ด้วยการนำราคาต่อหน่วยมาคูณกับจำนวนชิ้นที่ซื้อ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Quantity&#39;</span><span class="p">]</span>
<span class="n">customer_total_spend</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">)[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h4><span class="section-number">2.13.1.4. </span>การนำคอลัมน์มาต่อกัน<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h4>
<p>จากต้นคาบ นักศึกษาได้ใช้ <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> ไปแล้ว แต่เป็นการนำสองตารางมาต่อกันในแนวดิ่ง</p>
<p>สำหรับในหัวข้อนี้ เราต้องการนำตารางมาต่อกันในแนวราบ กล่าวคือ แต่ละแถวที่มี <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> ตรงกัน จะถูกนำมาต่อกัน ซึ่งสามารถทำได้ด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">pd.concat(...,</span> <span class="pre">axis=1)</span></code> ที่เพิ่มพารามิเตอร์ <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> เข้ามา</p>
<p>อนึ่ง ใน <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> นั้น มีการนิยามแกน (axis) เป็นค่า ดังนี้</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">axis=0</span></code> หมายถึงแกนนอน (กระทำกับคอลัมน์ที่ชื่อเหมือนกัน) (มักใช้เป็นค่า <strong>default</strong> ในหลายฟังก์ชัน)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis=1</span></code> หมายถึงแกนตั้ง (กระทำกับแถวที่ index เหมือนกัน) (โดยปกติมักจะต้องระบุเอง)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span> <span class="p">(</span><span class="n">customer_invoiceno</span><span class="p">,</span> <span class="n">customer_total_spend</span><span class="p">,</span> <span class="n">customer_duration</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4dd90145-011f-4b3d-9645-96970948d8ea" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>sum</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>CustomerID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12347</th>
      <td>1</td>
      <td>22</td>
      <td>584.91</td>
      <td>2011-08-02 08:48:00</td>
      <td>2011-08-02 08:48:00</td>
    </tr>
    <tr>
      <th>12358</th>
      <td>1</td>
      <td>12</td>
      <td>484.86</td>
      <td>2011-07-12 10:04:00</td>
      <td>2011-07-12 10:04:00</td>
    </tr>
    <tr>
      <th>12360</th>
      <td>1</td>
      <td>30</td>
      <td>534.70</td>
      <td>2011-08-19 10:10:00</td>
      <td>2011-08-19 10:10:00</td>
    </tr>
    <tr>
      <th>12362</th>
      <td>3</td>
      <td>46</td>
      <td>755.11</td>
      <td>2011-07-07 12:32:00</td>
      <td>2011-08-19 10:38:00</td>
    </tr>
    <tr>
      <th>12363</th>
      <td>1</td>
      <td>7</td>
      <td>252.90</td>
      <td>2011-08-22 10:18:00</td>
      <td>2011-08-22 10:18:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18265</th>
      <td>1</td>
      <td>29</td>
      <td>488.55</td>
      <td>2011-07-04 15:26:00</td>
      <td>2011-07-04 15:26:00</td>
    </tr>
    <tr>
      <th>18268</th>
      <td>2</td>
      <td>1</td>
      <td>0.00</td>
      <td>2011-07-28 11:16:00</td>
      <td>2011-07-28 19:13:00</td>
    </tr>
    <tr>
      <th>18272</th>
      <td>2</td>
      <td>50</td>
      <td>1125.91</td>
      <td>2011-07-12 15:42:00</td>
      <td>2011-08-18 12:06:00</td>
    </tr>
    <tr>
      <th>18282</th>
      <td>2</td>
      <td>7</td>
      <td>98.76</td>
      <td>2011-08-05 13:35:00</td>
      <td>2011-08-09 15:10:00</td>
    </tr>
    <tr>
      <th>18283</th>
      <td>2</td>
      <td>54</td>
      <td>143.19</td>
      <td>2011-07-14 13:00:00</td>
      <td>2011-07-14 13:20:00</td>
    </tr>
  </tbody>
</table>
<p>1540 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4dd90145-011f-4b3d-9645-96970948d8ea')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4dd90145-011f-4b3d-9645-96970948d8ea button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4dd90145-011f-4b3d-9645-96970948d8ea');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0c3fa983-3bf6-4491-9603-a55ca3dd071b">
  <button class="colab-df-quickchart" onclick="quickchart('df-0c3fa983-3bf6-4491-9603-a55ca3dd071b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0c3fa983-3bf6-4491-9603-a55ca3dd071b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="aggregration">
<h3><span class="section-number">2.13.2. </span><strong>วิธีที่ 2</strong> การทำ Aggregration โดยการระบุฟังก์ชันจำเพาะกับแต่ละคอลัมน์<a class="headerlink" href="#aggregration" title="Permalink to this heading">#</a></h3>
<p>วิธีการนี้ ทำได้โดยการส่ง Dictionary ให้กับ <code class="docutils literal notranslate"><span class="pre">.agg</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">:[</span><span class="s1">&#39;nunique&#39;</span><span class="p">],</span>
     <span class="s1">&#39;StockCode&#39;</span><span class="p">:[</span><span class="s1">&#39;nunique&#39;</span><span class="p">],</span>
     <span class="s1">&#39;Total&#39;</span><span class="p">:[</span><span class="s1">&#39;sum&#39;</span><span class="p">],</span>
     <span class="s1">&#39;InvoiceDate&#39;</span><span class="p">:[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">],</span>
     <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5aaa0b0e-b7e9-400f-ac11-a7e64add7d0d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Total</th>
      <th colspan="2" halign="left">InvoiceDate</th>
    </tr>
    <tr>
      <th></th>
      <th>nunique</th>
      <th>nunique</th>
      <th>sum</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>CustomerID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12347</th>
      <td>1</td>
      <td>22</td>
      <td>584.91</td>
      <td>2011-08-02 08:48:00</td>
      <td>2011-08-02 08:48:00</td>
    </tr>
    <tr>
      <th>12358</th>
      <td>1</td>
      <td>12</td>
      <td>484.86</td>
      <td>2011-07-12 10:04:00</td>
      <td>2011-07-12 10:04:00</td>
    </tr>
    <tr>
      <th>12360</th>
      <td>1</td>
      <td>30</td>
      <td>534.70</td>
      <td>2011-08-19 10:10:00</td>
      <td>2011-08-19 10:10:00</td>
    </tr>
    <tr>
      <th>12362</th>
      <td>3</td>
      <td>46</td>
      <td>755.11</td>
      <td>2011-07-07 12:32:00</td>
      <td>2011-08-19 10:38:00</td>
    </tr>
    <tr>
      <th>12363</th>
      <td>1</td>
      <td>7</td>
      <td>252.90</td>
      <td>2011-08-22 10:18:00</td>
      <td>2011-08-22 10:18:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18265</th>
      <td>1</td>
      <td>29</td>
      <td>488.55</td>
      <td>2011-07-04 15:26:00</td>
      <td>2011-07-04 15:26:00</td>
    </tr>
    <tr>
      <th>18268</th>
      <td>2</td>
      <td>1</td>
      <td>0.00</td>
      <td>2011-07-28 11:16:00</td>
      <td>2011-07-28 19:13:00</td>
    </tr>
    <tr>
      <th>18272</th>
      <td>2</td>
      <td>50</td>
      <td>1125.91</td>
      <td>2011-07-12 15:42:00</td>
      <td>2011-08-18 12:06:00</td>
    </tr>
    <tr>
      <th>18282</th>
      <td>2</td>
      <td>7</td>
      <td>98.76</td>
      <td>2011-08-05 13:35:00</td>
      <td>2011-08-09 15:10:00</td>
    </tr>
    <tr>
      <th>18283</th>
      <td>2</td>
      <td>54</td>
      <td>143.19</td>
      <td>2011-07-14 13:00:00</td>
      <td>2011-07-14 13:20:00</td>
    </tr>
  </tbody>
</table>
<p>1540 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5aaa0b0e-b7e9-400f-ac11-a7e64add7d0d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5aaa0b0e-b7e9-400f-ac11-a7e64add7d0d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5aaa0b0e-b7e9-400f-ac11-a7e64add7d0d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5195d8c4-dae8-43ac-aec1-921b80c63f87">
  <button class="colab-df-quickchart" onclick="quickchart('df-5195d8c4-dae8-43ac-aec1-921b80c63f87')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5195d8c4-dae8-43ac-aec1-921b80c63f87 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p><strong>ลองทำ</strong></p>
<p>ก่อนจบจากส่วนนี้ และเข้าสู่เนื้อหาของการวาดกราฟ ขอให้นักศึกษาศึกษา การใช้งานฟังก์ชัน <code class="docutils literal notranslate"><span class="pre">to_excel()</span></code> ตามลิงค์นี้</p>
<p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html</a></p>
<p>เพื่อบันทึกตารางผลลัพธ์ที่ได้จากการทำ aggregation ลงไฟล์ Excel จากนั้นลองดาวน์โหลดไฟล์ที่ได้ ไปเปิดในโปรแกรม Excel ในเครื่องคอมพิวเตอร์ของนักศึกษา</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id14">
<h1><span class="section-number">3. </span>การวาดกราฟ<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h1>
<p>ในหัวข้อนี้ จะมุ่งเน้นที่การวาดกราฟแบบต่าง ๆ  แต่เนื่องจากข้อมูลที่มีจำเป็นต้องทำการ clean ก่อน ซึ่งจะทำดังนี้</p>
<section id="data-cleansing">
<h2><span class="section-number">3.1. </span>Data cleansing<a class="headerlink" href="#data-cleansing" title="Permalink to this heading">#</a></h2>
<p>การทำความสะอาดข้อมูล จะทำความสะอาดอะไรบ้าง จำเป็นจะต้องทราบก่อนว่าจะวิเคราะห์ไปเพื่ออะไร สมมติว่าสนใจวิเคราะห์เกี่ยวกับพฤติกรรมของลูกค้า ดังนั้น จึงขอทำความสะอาดข้อมูลดังนี้</p>
<ol class="arabic simple">
<li><p>เนื่องจากสนใจเฉพาะแถวที่เป็นคำสั่งซื้อของลูกค้า ดังนั้นจึงจำเป็นต้องมี <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> จึงลบแถวที่มี <code class="docutils literal notranslate"><span class="pre">CustomerID</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ออกไป</p></li>
<li><p>ลบ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ที่ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> และ <code class="docutils literal notranslate"><span class="pre">A</span></code> เพราะคำสั่งซื้อที่ถูกยกเลิกถูกลง <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p>ไม่สนใจ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> เท่าับ <code class="docutils literal notranslate"><span class="pre">0</span></code> เพราะอาจเป็นของแจกฟรี (สมมติฐาน)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">])</span>  <span class="c1"># ข้อ 1</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">))]</span>  <span class="c1"># ข้อ 2</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;UnitPrice&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># ข้อ 3</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h2><span class="section-number">3.2. </span>ลูกค้ามาจากไหนบ้าง<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h2>
<p>ก่อนอื่น นักศึกษาลองหาสิว่า จากข้อมูลในตัวแปร <code class="docutils literal notranslate"><span class="pre">df</span></code></p>
<ul class="simple">
<li><p>มีลูกค้าทั้งหมดกี่ราย</p></li>
<li><p>มีประเทศที่เป็นไปได้ทั้งหมด กี่ประเทศ</p></li>
</ul>
<section id="id16">
<h3><span class="section-number">3.2.1. </span>การแจกแจงจำนวนลูกค้าตามรายประเทศ<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="n">per_customer</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">])</span>
<span class="n">n_customers</span> <span class="o">=</span> <span class="n">per_customer</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>  <span class="c1"># ได้ Series</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">n_customers</span><span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;การแจกแจงจำนวนลูกค้าตามรายประเทศ แบบที่ 1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="3e18c73c-d3fa-4820-8d50-bf530bab7082" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3e18c73c-d3fa-4820-8d50-bf530bab7082")) {                    Plotly.newPlot(                        "3e18c73c-d3fa-4820-8d50-bf530bab7082",                        [{"alignmentgroup":"True","hovertemplate":"variable=CustomerID\u003cbr\u003eCountry=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CustomerID","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"CustomerID","offsetgroup":"CustomerID","orientation":"v","showlegend":true,"textposition":"auto","texttemplate":"%{y}","x":["Australia","Austria","Belgium","Canada","Channel Islands","Denmark","EIRE","European Community","Finland","France","Germany","Greece","Iceland","Israel","Italy","Japan","Malta","Netherlands","Norway","Poland","Portugal","Singapore","Spain","Sweden","Switzerland","United Kingdom","Unspecified"],"xaxis":"x","y":[3,4,10,2,4,2,3,1,4,32,42,1,1,2,3,2,2,1,3,4,4,1,11,5,7,1339,3],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Country"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e01\u0e41\u0e08\u0e07\u0e08\u0e33\u0e19\u0e27\u0e19\u0e25\u0e39\u0e01\u0e04\u0e49\u0e32\u0e15\u0e32\u0e21\u0e23\u0e32\u0e22\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28 \u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 1"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3e18c73c-d3fa-4820-8d50-bf530bab7082');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>แต่เนื่องจาก United Kingdom มีมากเกินไป ทำให้อ่านกราฟได้ยาก จึงขอตัดออกจากกราฟเลย ด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">Series.drop()</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_customers</span> <span class="o">=</span> <span class="n">per_customer</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;United Kingdom&#39;</span><span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">n_customers</span><span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;การแจกแจงจำนวนลูกค้าตามรายประเทศ แบบที่ 2 (exclude UK)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="eb87b003-0ef6-4f5f-8a96-e77eef5116ae" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eb87b003-0ef6-4f5f-8a96-e77eef5116ae")) {                    Plotly.newPlot(                        "eb87b003-0ef6-4f5f-8a96-e77eef5116ae",                        [{"alignmentgroup":"True","hovertemplate":"variable=CustomerID\u003cbr\u003eCountry=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CustomerID","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"CustomerID","offsetgroup":"CustomerID","orientation":"v","showlegend":true,"textposition":"auto","texttemplate":"%{y}","x":["Australia","Austria","Belgium","Canada","Channel Islands","Denmark","EIRE","European Community","Finland","France","Germany","Greece","Iceland","Israel","Italy","Japan","Malta","Netherlands","Norway","Poland","Portugal","Singapore","Spain","Sweden","Switzerland","Unspecified"],"xaxis":"x","y":[3,4,10,2,4,2,3,1,4,32,42,1,1,2,3,2,2,1,3,4,4,1,11,5,7,3],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Country"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e01\u0e41\u0e08\u0e07\u0e08\u0e33\u0e19\u0e27\u0e19\u0e25\u0e39\u0e01\u0e04\u0e49\u0e32\u0e15\u0e32\u0e21\u0e23\u0e32\u0e22\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28 \u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 2 (exclude UK)"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eb87b003-0ef6-4f5f-8a96-e77eef5116ae');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>หรืออีกทางเลือกหนึ่งคือ ใช้แกนตั้งให้เป็น log scale โดยใช้พารามิเตอร์ <code class="docutils literal notranslate"><span class="pre">log_y=True</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_customers</span> <span class="o">=</span> <span class="n">per_customer</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">n_customers</span><span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;การแจกแจงจำนวนลูกค้าตามรายประเทศ แบบที่ 3 (log-scale)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="d17e9ab8-da60-4855-a9df-1f8d29331b40" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d17e9ab8-da60-4855-a9df-1f8d29331b40")) {                    Plotly.newPlot(                        "d17e9ab8-da60-4855-a9df-1f8d29331b40",                        [{"alignmentgroup":"True","hovertemplate":"variable=CustomerID\u003cbr\u003eCountry=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"CustomerID","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"CustomerID","offsetgroup":"CustomerID","orientation":"v","showlegend":true,"textposition":"auto","texttemplate":"%{y}","x":["Australia","Austria","Belgium","Canada","Channel Islands","Denmark","EIRE","European Community","Finland","France","Germany","Greece","Iceland","Israel","Italy","Japan","Malta","Netherlands","Norway","Poland","Portugal","Singapore","Spain","Sweden","Switzerland","United Kingdom","Unspecified"],"xaxis":"x","y":[3,4,10,2,4,2,3,1,4,32,42,1,1,2,3,2,2,1,3,4,4,1,11,5,7,1339,3],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Country"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"},"type":"log"},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e01\u0e41\u0e08\u0e07\u0e08\u0e33\u0e19\u0e27\u0e19\u0e25\u0e39\u0e01\u0e04\u0e49\u0e32\u0e15\u0e32\u0e21\u0e23\u0e32\u0e22\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28 \u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 3 (log-scale)"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d17e9ab8-da60-4855-a9df-1f8d29331b40');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>หรือจะลองใช้ Pie chart (<a class="reference external" href="https://plotly.com/python/pie-charts/">คู่มือ</a>) แทน Bar chart</p>
<p>รูปแบบการใช้คำสั่งสร้าง Pie chart คือ</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">ข้อมูลที่เป็นDataFrame</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">ชื่อคอลัมน์ที่เก็บตัวเลข</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">ชื่อกำกับตัวเลข</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_customers</span> <span class="o">=</span> <span class="p">(</span> <span class="n">per_customer</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)[</span><span class="s1">&#39;CustomerID&#39;</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">nunique</span><span class="p">()</span>      <span class="c1"># ได้ Series ที่มี Country เป็น index โดยที่ Series ถูกตั้งชื่อว่า CustomerID</span>
                    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;No of customers&#39;</span><span class="p">)</span>  <span class="c1"># ไม่ต้องการให้ Series ชื่อ CustomerID จึงแก้ชื่อเป็น No of customers</span>
                    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;United Kingdom&#39;</span><span class="p">)</span>  <span class="c1"># เอาค่าของ index=&#39;United Kingdom&#39; ออกจาก Series</span>
                    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>    <span class="c1"># ทำให้ Series กลายเป็น DataFrame  ค่าของ Series จะกลายมาเป็นคอลัมน์ชื่อ No of customers</span>
<span class="p">)</span>
<span class="n">n_customers</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ecd70244-3c3c-490a-a44b-5b38b0cf87ac" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>No of customers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Australia</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austria</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belgium</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Canada</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Channel Islands</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ecd70244-3c3c-490a-a44b-5b38b0cf87ac')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ecd70244-3c3c-490a-a44b-5b38b0cf87ac button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ecd70244-3c3c-490a-a44b-5b38b0cf87ac');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b6dae1ee-9afe-44ab-9398-ace2fee3fb87">
  <button class="colab-df-quickchart" onclick="quickchart('df-b6dae1ee-9afe-44ab-9398-ace2fee3fb87')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b6dae1ee-9afe-44ab-9398-ace2fee3fb87 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">n_customers</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;No of customers&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span>  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;การแจกแจงสัดส่วนลูกค้าตามรายประเทศ แบบที่ 4 (exclude UK)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="eba2d47a-316a-4e1f-a295-ad3be35bfaa3" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eba2d47a-316a-4e1f-a295-ad3be35bfaa3")) {                    Plotly.newPlot(                        "eba2d47a-316a-4e1f-a295-ad3be35bfaa3",                        [{"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"hovertemplate":"Country=%{label}\u003cbr\u003eNo of customers=%{value}\u003cextra\u003e\u003c\u002fextra\u003e","labels":["Australia","Austria","Belgium","Canada","Channel Islands","Denmark","EIRE","European Community","Finland","France","Germany","Greece","Iceland","Israel","Italy","Japan","Malta","Netherlands","Norway","Poland","Portugal","Singapore","Spain","Sweden","Switzerland","Unspecified"],"legendgroup":"","name":"","showlegend":true,"values":[3,4,10,2,4,2,3,1,4,32,42,1,1,2,3,2,2,1,3,4,4,1,11,5,7,3],"type":"pie"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"legend":{"tracegroupgap":0},"title":{"text":"\u0e01\u0e32\u0e23\u0e41\u0e08\u0e01\u0e41\u0e08\u0e07\u0e2a\u0e31\u0e14\u0e2a\u0e48\u0e27\u0e19\u0e25\u0e39\u0e01\u0e04\u0e49\u0e32\u0e15\u0e32\u0e21\u0e23\u0e32\u0e22\u0e1b\u0e23\u0e30\u0e40\u0e17\u0e28 \u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 4 (exclude UK)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eba2d47a-316a-4e1f-a295-ad3be35bfaa3');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
</section>
</section>
<section id="id17">
<h2><span class="section-number">3.3. </span>คำสั่งซื้อจากแต่ละประเทศ เกิดขึ้นก่อนเที่ยงหรือหลังเที่ยง<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h2>
<p>ตัวอย่างนี้เป็นเพียงตัวอย่างการวาดกราฟเท่านั้น แต่ข้อเท็จจริงที่นำไปวาดกราฟอาจไม่ถูกต้อง เนื่องจากไม่ทราบว่า <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> คือเวลาใน Time zone ไหน จึงขอตั้งสมมติฐานว่าเป็นเวลาของ UK เนื่องจากบริษัทจดทะเบียนที่ UK และลูกค้าส่วนใหญ่มาจาก UK</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">,</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;BeforeNoon&#39;</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">,</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;BeforeNoon&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s1">&#39;BeforeNoon&#39;</span><span class="p">,</span>
                   <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                   <span class="n">text_auto</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">log_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="47940a92-2a1e-447c-a0f8-1d34346d6289" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("47940a92-2a1e-447c-a0f8-1d34346d6289")) {                    Plotly.newPlot(                        "47940a92-2a1e-447c-a0f8-1d34346d6289",                        [{"alignmentgroup":"True","bingroup":"x","hovertemplate":"BeforeNoon=True\u003cbr\u003eCountry=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"True","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"True","offsetgroup":"True","orientation":"v","showlegend":true,"texttemplate":"%{value}","x":["Australia","Australia","Australia","Australia","Australia","Austria","Austria","Austria","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Canada","Canada","Canada","Channel Islands","Channel Islands","Channel Islands","Channel Islands","Denmark","Denmark","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","European Community","Finland","Finland","Finland","Finland","Finland","Finland","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Iceland","Israel","Israel","Italy","Italy","Japan","Malta","Netherlands","Netherlands","Norway","Norway","Poland","Poland","Poland","Poland","Portugal","Portugal","Portugal","Singapore","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Sweden","Sweden","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","Unspecified","Unspecified"],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","hovertemplate":"BeforeNoon=False\u003cbr\u003eCountry=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"False","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"False","offsetgroup":"False","orientation":"v","showlegend":true,"texttemplate":"%{value}","x":["Australia","Australia","Australia","Australia","Austria","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Channel Islands","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","EIRE","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Greece","Italy","Italy","Italy","Japan","Malta","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Norway","Portugal","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Switzerland","Switzerland","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","Unspecified","Unspecified","Unspecified"],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Country"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"},"type":"log"},"legend":{"title":{"text":"BeforeNoon"},"tracegroupgap":0},"margin":{"t":60},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('47940a92-2a1e-447c-a0f8-1d34346d6289');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>หากสงสัยว่ากราฟที่วาด ผิดหรือไม่ ก็ตรวจสอบได้จากคำสั่งของ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> อีกทาง</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)[</span><span class="s1">&#39;BeforeNoon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Country             BeforeNoon
Australia           True             5
                    False            4
Austria             True             3
                    False            1
Belgium             False            8
                    True             6
Canada              True             3
Channel Islands     True             4
                    False            1
Denmark             True             2
EIRE                False           21
                    True            18
European Community  True             1
Finland             True             6
France              True            35
                    False           15
Germany             True            39
                    False           33
Greece              False            1
Iceland             True             1
Israel              True             2
Italy               False            3
                    True             2
Japan               False            1
                    True             1
Malta               False            1
                    True             1
Netherlands         False            6
                    True             2
Norway              True             2
                    False            1
Poland              True             4
Portugal            True             3
                    False            1
Singapore           True             1
Spain               True            10
                    False            9
Sweden              False            6
                    True             2
Switzerland         True             6
                    False            2
United Kingdom      True          1192
                    False         1141
Unspecified         False            3
                    True             2
Name: BeforeNoon, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id18">
<h2><span class="section-number">3.4. </span>ปริมาณคำสั่งซื้อต่อวันเป็นอย่างไรบ้าง<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h2>
<p>ขอให้นักศึกษาลองคิดดูว่า การจะคำนวณปริมาณคำสั่งซื้อในแต่ละวัน จะทำได้อย่างไร นักศึกษาอาจดึงเฉพาะวันที่ออกจาก <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> (เพราะไม่อยากได้ค่าเวลา) ไปสร้างเป็นคอลัมน์ใหม่แล้ว ซึ่งหากนำวันที่มาจัดกลุ่มด้วย <code class="docutils literal notranslate"><span class="pre">groupby</span></code> ก็จะได้กลุ่มย่อยของ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> เป็นรายวัน ซึ่งสามารถนับจำนวน <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ที่ไม่ซ้ำกันในหนึ่งวัน ได้ด้วย <code class="docutils literal notranslate"><span class="pre">nunique()</span></code> ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;InvoiceDateOnly&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>   <span class="c1"># dt.date จะใด้ datetime แต่ dt.day จะได้เลขวันที่</span>
<span class="n">invoice_by_day</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;InvoiceDateOnly&#39;</span><span class="p">)[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">invoice_by_day</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ปริมาณคำสั่งซื้อในแต่ละวัน (แบบที่ 1 ใช้ groupby)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="60b5e9e2-0a28-4e09-938a-dd56b7d9343f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("60b5e9e2-0a28-4e09-938a-dd56b7d9343f")) {                    Plotly.newPlot(                        "60b5e9e2-0a28-4e09-938a-dd56b7d9343f",                        [{"hovertemplate":"variable=InvoiceNo\u003cbr\u003eInvoiceDateOnly=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"InvoiceNo","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines+markers","name":"InvoiceNo","orientation":"v","showlegend":true,"x":["2011-07-01","2011-07-03","2011-07-04","2011-07-05","2011-07-06","2011-07-07","2011-07-08","2011-07-10","2011-07-11","2011-07-12","2011-07-13","2011-07-14","2011-07-15","2011-07-17","2011-07-18","2011-07-19","2011-07-20","2011-07-21","2011-07-22","2011-07-24","2011-07-25","2011-07-26","2011-07-27","2011-07-28","2011-07-29","2011-07-31","2011-08-01","2011-08-02","2011-08-03","2011-08-04","2011-08-05","2011-08-07","2011-08-08","2011-08-09","2011-08-10","2011-08-11","2011-08-12","2011-08-14","2011-08-15","2011-08-16","2011-08-17","2011-08-18","2011-08-19","2011-08-21","2011-08-22","2011-08-23","2011-08-24","2011-08-25","2011-08-26","2011-08-28","2011-08-30","2011-08-31"],"xaxis":"x","y":[42,25,37,64,66,73,46,24,48,45,56,69,37,50,46,62,53,70,37,57,53,46,44,78,62,41,39,41,62,79,52,29,38,40,43,64,46,25,48,50,51,67,55,38,63,60,72,72,44,37,23,42],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"InvoiceDateOnly"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"\u0e1b\u0e23\u0e34\u0e21\u0e32\u0e13\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e0b\u0e37\u0e49\u0e2d\u0e43\u0e19\u0e41\u0e15\u0e48\u0e25\u0e30\u0e27\u0e31\u0e19 (\u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 1 \u0e43\u0e0a\u0e49 groupby)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('60b5e9e2-0a28-4e09-938a-dd56b7d9343f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>อย่างไรก็ตาม กราฟที่ได้จะข้ามบางวันไป ซึ่งดูจากกราฟอาจจะดูไม่ค่อยออก ดังนั้น ในหลายกรณี จึงจำเป็นที่จะต้องเติมวันที่ที่ขาดหายไปเข้าไปด้วย ดังนั้นจึงเป็นที่มาของการวาดกราฟแบบที่ 2 ที่ใช้คำสั่ง <code class="docutils literal notranslate"><span class="pre">set_index()</span></code> ตามด้วย <code class="docutils literal notranslate"><span class="pre">resample()</span></code></p>
<section id="set-index">
<h3><span class="section-number">3.4.1. </span>คำสั่ง <code class="docutils literal notranslate"><span class="pre">set_index()</span></code><a class="headerlink" href="#set-index" title="Permalink to this heading">#</a></h3>
<p>เป็นคำสั่งที่ใช้กำหนดให้คอลัมน์ที่ต้องการ กลายเป็น <code class="docutils literal notranslate"><span class="pre">index</span></code> ของ <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-18dd9429-94f1-43fc-b5d2-49179a886112" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>InvoiceNo</th>
      <th>StockCode</th>
      <th>Description</th>
      <th>Quantity</th>
      <th>UnitPrice</th>
      <th>CustomerID</th>
      <th>Country</th>
      <th>Sheet</th>
      <th>MonthNo</th>
      <th>WeekNo</th>
      <th>BeforeNoon</th>
      <th>DaysToXmas</th>
      <th>Total</th>
      <th>InvoiceDateOnly</th>
    </tr>
    <tr>
      <th>InvoiceDate</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2011-07-01 08:16:00</th>
      <td>0</td>
      <td>558638</td>
      <td>84836</td>
      <td>ZINC METAL HEART DECORATION</td>
      <td>12</td>
      <td>1.25</td>
      <td>16317</td>
      <td>United Kingdom</td>
      <td>July</td>
      <td>7</td>
      <td>26</td>
      <td>True</td>
      <td>176</td>
      <td>15.00</td>
      <td>2011-07-01</td>
    </tr>
    <tr>
      <th>2011-07-01 08:16:00</th>
      <td>1</td>
      <td>558638</td>
      <td>71459</td>
      <td>HANGING JAM JAR T-LIGHT HOLDER</td>
      <td>24</td>
      <td>0.85</td>
      <td>16317</td>
      <td>United Kingdom</td>
      <td>July</td>
      <td>7</td>
      <td>26</td>
      <td>True</td>
      <td>176</td>
      <td>20.40</td>
      <td>2011-07-01</td>
    </tr>
    <tr>
      <th>2011-07-01 08:16:00</th>
      <td>2</td>
      <td>558638</td>
      <td>22784</td>
      <td>LANTERN CREAM GAZEBO</td>
      <td>3</td>
      <td>4.95</td>
      <td>16317</td>
      <td>United Kingdom</td>
      <td>July</td>
      <td>7</td>
      <td>26</td>
      <td>True</td>
      <td>176</td>
      <td>14.85</td>
      <td>2011-07-01</td>
    </tr>
    <tr>
      <th>2011-07-01 08:16:00</th>
      <td>3</td>
      <td>558638</td>
      <td>23145</td>
      <td>ZINC T-LIGHT HOLDER STAR LARGE</td>
      <td>12</td>
      <td>0.95</td>
      <td>16317</td>
      <td>United Kingdom</td>
      <td>July</td>
      <td>7</td>
      <td>26</td>
      <td>True</td>
      <td>176</td>
      <td>11.40</td>
      <td>2011-07-01</td>
    </tr>
    <tr>
      <th>2011-07-01 08:16:00</th>
      <td>4</td>
      <td>558638</td>
      <td>22674</td>
      <td>FRENCH TOILET SIGN BLUE METAL</td>
      <td>12</td>
      <td>1.25</td>
      <td>16317</td>
      <td>United Kingdom</td>
      <td>July</td>
      <td>7</td>
      <td>26</td>
      <td>True</td>
      <td>176</td>
      <td>15.00</td>
      <td>2011-07-01</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-18dd9429-94f1-43fc-b5d2-49179a886112')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-18dd9429-94f1-43fc-b5d2-49179a886112 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-18dd9429-94f1-43fc-b5d2-49179a886112');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-95045698-708c-45f6-866e-6e7754b3d3c0">
  <button class="colab-df-quickchart" onclick="quickchart('df-95045698-708c-45f6-866e-6e7754b3d3c0')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-95045698-708c-45f6-866e-6e7754b3d3c0 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<p>จะเห็นว่า ตอนนี้ <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> ถูกเปลี่ยนให้เป็น index โดยที่คอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> เดิม และ index เดิมก็หายไปด้วย ทั้งนี้มีข้อสังเกตุคือ การที่ <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> มีค่าซ้ำกันได้  ทำให้ index ที่ได้มีค่าไม่เป็นเอกลักษณ์เฉพาะแถว</p>
<p>เมื่อได้ index ที่เป็นวันเวลา โดยที่วันเวลาถูกเรียงลำดับจากน้อยไปมากไว้ก่อนแล้ว (หากยังไม่เรียง ก็ให้ใช้ <code class="docutils literal notranslate"><span class="pre">DataFrame.sort_index()</span></code> ก่อน) จะสามารถใช้คำสั่ง <code class="docutils literal notranslate"><span class="pre">resample()</span> <span class="pre">ได้</span> </code> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#resampling">คู่มือ</a>  ซึ่ง <code class="docutils literal notranslate"><span class="pre">resample()</span></code> จะทำงานคล้าย <code class="docutils literal notranslate"><span class="pre">groupby</span></code> และยังสามารถเติมวันเวลาที่ขาดหายเข้าไปด้วย</p>
<p>สำหรับในตัวอย่างต่อไปนี้ <code class="docutils literal notranslate"><span class="pre">.resample('D')</span></code> จะเป็นการไล่วันเวลาในระดับวันที่</p>
<p><code class="docutils literal notranslate"><span class="pre">2011-07-01</span></code>, <code class="docutils literal notranslate"><span class="pre">2011-07-02</span></code>, <code class="docutils literal notranslate"><span class="pre">2011-07-03</span></code>, …</p>
<p>ซึ่งสามารถเป็นการไล่เวลาในระดับชั่วโมง, สัปดาห์, เดือน เป็นต้น ซึ่งสามารถดูเพิ่มเติมได้จากคู่มือ</p>
<p>หลังจาก <code class="docutils literal notranslate"><span class="pre">resample('D')</span></code>  แล้ว จึงทำการเลือกเฉพาะคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> และ aggregrate ข้อมูลในแต่ละวัน ด้วยคำสั่ง <code class="docutils literal notranslate"><span class="pre">nunique()</span></code> เพื่อนับจำนวน <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ที่ไม่ซ้ำกันในวันใด ๆ</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)[</span><span class="s1">&#39;InvoiceNo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>InvoiceDate
2011-07-01    42
2011-07-02     0
2011-07-03    25
2011-07-04    37
2011-07-05    64
              ..
2011-08-27     0
2011-08-28    37
2011-08-29     0
2011-08-30    23
2011-08-31    42
Freq: D, Name: InvoiceNo, Length: 62, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>จากคำอธิบายข้างต้น สามารถนำมาสรุปเขียนเป็นคำสั่งในคราวเดียว และวาดกราฟเส้น ได้ ดังนี้</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invoice_by_day</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;InvoiceDate&#39;</span><span class="p">)</span>
                      <span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">)[</span><span class="s2">&quot;InvoiceNo&quot;</span><span class="p">]</span>
                      <span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">invoice_by_day</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ปริมาณคำสั่งซื้อในแต่ละวัน (แบบที่ 2 ใช้ resample)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="08ef9e62-e36e-4d62-af1f-a24e1484aa5a" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("08ef9e62-e36e-4d62-af1f-a24e1484aa5a")) {                    Plotly.newPlot(                        "08ef9e62-e36e-4d62-af1f-a24e1484aa5a",                        [{"hovertemplate":"variable=InvoiceNo\u003cbr\u003eInvoiceDate=%{x}\u003cbr\u003evalue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"InvoiceNo","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines+markers","name":"InvoiceNo","orientation":"v","showlegend":true,"x":["2011-07-01T00:00:00","2011-07-02T00:00:00","2011-07-03T00:00:00","2011-07-04T00:00:00","2011-07-05T00:00:00","2011-07-06T00:00:00","2011-07-07T00:00:00","2011-07-08T00:00:00","2011-07-09T00:00:00","2011-07-10T00:00:00","2011-07-11T00:00:00","2011-07-12T00:00:00","2011-07-13T00:00:00","2011-07-14T00:00:00","2011-07-15T00:00:00","2011-07-16T00:00:00","2011-07-17T00:00:00","2011-07-18T00:00:00","2011-07-19T00:00:00","2011-07-20T00:00:00","2011-07-21T00:00:00","2011-07-22T00:00:00","2011-07-23T00:00:00","2011-07-24T00:00:00","2011-07-25T00:00:00","2011-07-26T00:00:00","2011-07-27T00:00:00","2011-07-28T00:00:00","2011-07-29T00:00:00","2011-07-30T00:00:00","2011-07-31T00:00:00","2011-08-01T00:00:00","2011-08-02T00:00:00","2011-08-03T00:00:00","2011-08-04T00:00:00","2011-08-05T00:00:00","2011-08-06T00:00:00","2011-08-07T00:00:00","2011-08-08T00:00:00","2011-08-09T00:00:00","2011-08-10T00:00:00","2011-08-11T00:00:00","2011-08-12T00:00:00","2011-08-13T00:00:00","2011-08-14T00:00:00","2011-08-15T00:00:00","2011-08-16T00:00:00","2011-08-17T00:00:00","2011-08-18T00:00:00","2011-08-19T00:00:00","2011-08-20T00:00:00","2011-08-21T00:00:00","2011-08-22T00:00:00","2011-08-23T00:00:00","2011-08-24T00:00:00","2011-08-25T00:00:00","2011-08-26T00:00:00","2011-08-27T00:00:00","2011-08-28T00:00:00","2011-08-29T00:00:00","2011-08-30T00:00:00","2011-08-31T00:00:00"],"xaxis":"x","y":[42,0,25,37,64,66,73,46,0,24,48,45,56,69,37,0,50,46,62,53,70,37,0,57,53,46,44,78,62,0,41,39,41,62,79,52,0,29,38,40,43,64,46,0,25,48,50,51,67,55,0,38,63,60,72,72,44,0,37,0,23,42],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"InvoiceDate"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"value"}},"legend":{"title":{"text":"variable"},"tracegroupgap":0},"title":{"text":"\u0e1b\u0e23\u0e34\u0e21\u0e32\u0e13\u0e04\u0e33\u0e2a\u0e31\u0e48\u0e07\u0e0b\u0e37\u0e49\u0e2d\u0e43\u0e19\u0e41\u0e15\u0e48\u0e25\u0e30\u0e27\u0e31\u0e19 (\u0e41\u0e1a\u0e1a\u0e17\u0e35\u0e48 2 \u0e43\u0e0a\u0e49 resample)"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('08ef9e62-e36e-4d62-af1f-a24e1484aa5a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
<p>จากกราฟ จะเห็นวันที่จำนวน Invoice เป็น 0 มันคือวันอะไร?</p>
<p><strong>จบเนื้อหา</strong></p>
<p>นักศึกษาลองสรุปซิว่า วันนี้นักศึกษาได้เรียนรู้คำสั่งอะไรบ้าง</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="lecture01.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">1. </span>สำรวจชุดข้อมูลทิป</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">2. สำรวจชุดข้อมูลขายของออนไลน์</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2.1. เริ่มต้นบทเรียน</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2.2. ดาวน์โหลดข้อมูล</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#excel">2.3. อ่านข้อมูลจากไฟล์ Excel</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sheet">2.3.1. อ่าน Sheet เดือนกรกฏาคม</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">2.3.2. อ่าน Sheet เดือนสิงหาคม</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1">2.4. Q1. ต้องการนำตารางมาต่อกัน</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-1">2.4.1. Q1.1 การเพิ่มคอลัมน์ที่เก็บค่าเดียวเหมือนกันหมด</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-2">2.4.2. Q1.2 การนำตารางมาต่อกัน</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q1-3">2.5. Q1.3 การลบคอลัมน์</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-inplace-true">2.6. เกร็ดการใช้ <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> (<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-quantity-unitprice">2.7. Q2 ตรวจสอบข้อมูล <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-1-quantity-0-unitprice-0">2.7.1. Q2.1 มี <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span> </code> หรือ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code> น้อยกว่า <code class="docutils literal notranslate"><span class="pre">0</span></code> หรือไม่</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q2-2-invoiceno-quantity-unitprice">2.7.2. Q2.2 <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> กับ <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> และ <code class="docutils literal notranslate"><span class="pre">UnitPrice</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoiceno-c-a">2.7.2.1. <strong>1) การเข้าถึงแถวที่ค่าในคอลัมน์ <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> หรือ <code class="docutils literal notranslate"><span class="pre">A</span></code></strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoiceno-c-quantity">2.7.2.2. 2) ถ้า <code class="docutils literal notranslate"><span class="pre">InvoiceNo</span></code> ขึ้นต้นด้วย <code class="docutils literal notranslate"><span class="pre">C</span></code> แล้ว <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> ติดลบเสมอ?</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2.7.2.3. <strong>แบบฝึกหัด</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q2">2.8. Q2 การแปลงชนิดข้อมูลให้ถูกประเภท</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframe-copy">2.9. เกร็ด: การทำซ้ำข้อมูล <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> ด้วย <code class="docutils literal notranslate"><span class="pre">.copy()</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copy">2.9.1. ทำไมต้องใช้ <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> ?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-missing-value">2.10. Q3 ข้อมูลที่ขาดหาย (Missing value)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-1-nan-dropna-false">2.10.1. Q3.1 ถ้าไม่อยากมองข้าม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ต้องกำหนด <code class="docutils literal notranslate"><span class="pre">dropna=False</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-2">2.10.2. Q3.2 เติมข้อมูลที่ขาดหายด้วยค่าคงที่</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q3-3-nan">2.10.3. Q3.3 ไม่รู้จะเติม <code class="docutils literal notranslate"><span class="pre">NaN</span></code> ด้วยอะไร ก็ลบซะเลย</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-groupby-and-aggregation">2.11. Q4 Groupby and Aggregation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-1">2.11.1. Q4.1 จะเข้าถึงกลุ่มย่อยได้อย่างไร</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-2">2.11.2. Q4.2 การทำข้อมูลภาพรวมจากกลุ่มย่อย</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q4-3-group">2.11.3. Q4.3 จะทราบได้อย่างไรว่า <code class="docutils literal notranslate"><span class="pre">group</span></code> ที่ได้มีกี่กลุ่ม อะไรบ้าง</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-datetime">2.12. Q5 เกี่ยวกับข้อมูลวันที่ (<code class="docutils literal notranslate"><span class="pre">datetime</span></code>)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-1-string-datetime">2.12.1. Q5.1 การแปลง <code class="docutils literal notranslate"><span class="pre">string</span></code> เป็น <code class="docutils literal notranslate"><span class="pre">datetime</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-2">2.12.2. Q5.2 การคำนวณส่วนต่างของเวลา</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#q5-3-datetime-series-dataframe">2.12.3. Q5.3 <code class="docutils literal notranslate"><span class="pre">datetime</span></code> ใน <code class="docutils literal notranslate"><span class="pre">Series/DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">2.12.3.1. เพิ่มคอลัมน์เลขเดือน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">2.12.3.2. เพิ่มคอลัมน์เลขสัปดาห์</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">2.12.3.3. เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อน 12.00 น. หรือไม่</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">2.12.3.4. เพิ่มคอลัมน์สถานะว่าคำสั่งซื้อมาก่อนวันคริสต์มาสปี 2011 กี่วัน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoicedate">2.12.3.5. ตอบคำถามว่า <code class="docutils literal notranslate"><span class="pre">InvoiceDate</span></code> แรกสุดและล่าสุดในคือวันและเวลาใด</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#q6">2.13. Q6 การรายงานข้อมูลเป็นรายลูกค้า</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">2.13.1. <strong>วิธีที่ 1</strong> ทำ 1,2,และ 3 แล้วค่อยนำมารวมกัน</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#invoice-invoice-stockcode">2.13.1.1. 1. ลูกค้าแต่ละคน มีจำนวน Invoice เกิดขึ้นกี่ Invoice และเกี่ยวข้องกับสินค้าทั้งหมดกี่ชนิด (<code class="docutils literal notranslate"><span class="pre">StockCode</span></code>)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">2.13.1.2. 2. ลูกค้าแต่ละคนเข้ามาแรกสุดและล่าสุดเมื่อใด (จากข้อมูลทั้งหมดที่มี)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">2.13.1.3. 3. ยอดซื้อรวมของลูกค้าแต่ละคน</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">2.13.1.4. การนำคอลัมน์มาต่อกัน</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregration">2.13.2. <strong>วิธีที่ 2</strong> การทำ Aggregration โดยการระบุฟังก์ชันจำเพาะกับแต่ละคอลัมน์</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">3. การวาดกราฟ</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleansing">3.1. Data cleansing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3.2. ลูกค้ามาจากไหนบ้าง</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">3.2.1. การแจกแจงจำนวนลูกค้าตามรายประเทศ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">3.3. คำสั่งซื้อจากแต่ละประเทศ เกิดขึ้นก่อนเที่ยงหรือหลังเที่ยง</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">3.4. ปริมาณคำสั่งซื้อต่อวันเป็นอย่างไรบ้าง</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-index">3.4.1. คำสั่ง <code class="docutils literal notranslate"><span class="pre">set_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kasemsit Teeyapan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>