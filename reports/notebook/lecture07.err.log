Traceback (most recent call last):
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 646, in run_until_complete
    return future.result()
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/kasemsit/269382/.venv/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
%reset -f
import pandas as pd
df = pd.read_excel('data.xlsx', sheet_name='Online Retail')  # การโหลดค่อนข้างช้า เพราะไฟล์มีขนาดใหญ่มาก
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mBadZipFile[0m                                Traceback (most recent call last)
Cell [0;32mIn[2], line 3[0m
[1;32m      1[0m get_ipython()[38;5;241m.[39mrun_line_magic([38;5;124m'[39m[38;5;124mreset[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124m-f[39m[38;5;124m'[39m)
[1;32m      2[0m [38;5;28;01mimport[39;00m [38;5;21;01mpandas[39;00m [38;5;28;01mas[39;00m [38;5;21;01mpd[39;00m
[0;32m----> 3[0m df [38;5;241m=[39m [43mpd[49m[38;5;241;43m.[39;49m[43mread_excel[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mdata.xlsx[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43msheet_name[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mOnline Retail[39;49m[38;5;124;43m'[39;49m[43m)[49m  [38;5;66;03m# การโหลดค่อนข้างช้า เพราะไฟล์มีขนาดใหญ่มาก[39;00m

File [0;32m~/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_base.py:504[0m, in [0;36mread_excel[0;34m(io, sheet_name, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, storage_options, dtype_backend, engine_kwargs)[0m
[1;32m    502[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(io, ExcelFile):
[1;32m    503[0m     should_close [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m--> 504[0m     io [38;5;241m=[39m [43mExcelFile[49m[43m([49m
[1;32m    505[0m [43m        [49m[43mio[49m[43m,[49m
[1;32m    506[0m [43m        [49m[43mstorage_options[49m[38;5;241;43m=[39;49m[43mstorage_options[49m[43m,[49m
[1;32m    507[0m [43m        [49m[43mengine[49m[38;5;241;43m=[39;49m[43mengine[49m[43m,[49m
[1;32m    508[0m [43m        [49m[43mengine_kwargs[49m[38;5;241;43m=[39;49m[43mengine_kwargs[49m[43m,[49m
[1;32m    509[0m [43m    [49m[43m)[49m
[1;32m    510[0m [38;5;28;01melif[39;00m engine [38;5;129;01mand[39;00m engine [38;5;241m!=[39m io[38;5;241m.[39mengine:
[1;32m    511[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m    512[0m         [38;5;124m"[39m[38;5;124mEngine should not be specified when passing [39m[38;5;124m"[39m
[1;32m    513[0m         [38;5;124m"[39m[38;5;124man ExcelFile - ExcelFile already has the engine set[39m[38;5;124m"[39m
[1;32m    514[0m     )

File [0;32m~/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_base.py:1580[0m, in [0;36mExcelFile.__init__[0;34m(self, path_or_buffer, engine, storage_options, engine_kwargs)[0m
[1;32m   1577[0m [38;5;28mself[39m[38;5;241m.[39mengine [38;5;241m=[39m engine
[1;32m   1578[0m [38;5;28mself[39m[38;5;241m.[39mstorage_options [38;5;241m=[39m storage_options
[0;32m-> 1580[0m [38;5;28mself[39m[38;5;241m.[39m_reader [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_engines[49m[43m[[49m[43mengine[49m[43m][49m[43m([49m
[1;32m   1581[0m [43m    [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_io[49m[43m,[49m
[1;32m   1582[0m [43m    [49m[43mstorage_options[49m[38;5;241;43m=[39;49m[43mstorage_options[49m[43m,[49m
[1;32m   1583[0m [43m    [49m[43mengine_kwargs[49m[38;5;241;43m=[39;49m[43mengine_kwargs[49m[43m,[49m
[1;32m   1584[0m [43m[49m[43m)[49m

File [0;32m~/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_openpyxl.py:553[0m, in [0;36mOpenpyxlReader.__init__[0;34m(self, filepath_or_buffer, storage_options, engine_kwargs)[0m
[1;32m    541[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m    542[0m [38;5;124;03mReader using openpyxl engine.[39;00m
[1;32m    543[0m 
[0;32m   (...)[0m
[1;32m    550[0m [38;5;124;03m    Arbitrary keyword arguments passed to excel engine.[39;00m
[1;32m    551[0m [38;5;124;03m"""[39;00m
[1;32m    552[0m import_optional_dependency([38;5;124m"[39m[38;5;124mopenpyxl[39m[38;5;124m"[39m)
[0;32m--> 553[0m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m
[1;32m    554[0m [43m    [49m[43mfilepath_or_buffer[49m[43m,[49m
[1;32m    555[0m [43m    [49m[43mstorage_options[49m[38;5;241;43m=[39;49m[43mstorage_options[49m[43m,[49m
[1;32m    556[0m [43m    [49m[43mengine_kwargs[49m[38;5;241;43m=[39;49m[43mengine_kwargs[49m[43m,[49m
[1;32m    557[0m [43m[49m[43m)[49m

File [0;32m~/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_base.py:582[0m, in [0;36mBaseExcelReader.__init__[0;34m(self, filepath_or_buffer, storage_options, engine_kwargs)[0m
[1;32m    580[0m [38;5;28mself[39m[38;5;241m.[39mhandles[38;5;241m.[39mhandle[38;5;241m.[39mseek([38;5;241m0[39m)
[1;32m    581[0m [38;5;28;01mtry[39;00m:
[0;32m--> 582[0m     [38;5;28mself[39m[38;5;241m.[39mbook [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mload_workbook[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mhandles[49m[38;5;241;43m.[39;49m[43mhandle[49m[43m,[49m[43m [49m[43mengine_kwargs[49m[43m)[49m
[1;32m    583[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:
[1;32m    584[0m     [38;5;28mself[39m[38;5;241m.[39mclose()

File [0;32m~/269382/.venv/lib/python3.10/site-packages/pandas/io/excel/_openpyxl.py:570[0m, in [0;36mOpenpyxlReader.load_workbook[0;34m(self, filepath_or_buffer, engine_kwargs)[0m
[1;32m    565[0m [38;5;28;01mdef[39;00m [38;5;21mload_workbook[39m(
[1;32m    566[0m     [38;5;28mself[39m, filepath_or_buffer: FilePath [38;5;241m|[39m ReadBuffer[[38;5;28mbytes[39m], engine_kwargs
[1;32m    567[0m ) [38;5;241m-[39m[38;5;241m>[39m Workbook:
[1;32m    568[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mopenpyxl[39;00m [38;5;28;01mimport[39;00m load_workbook
[0;32m--> 570[0m     [38;5;28;01mreturn[39;00m [43mload_workbook[49m[43m([49m
[1;32m    571[0m [43m        [49m[43mfilepath_or_buffer[49m[43m,[49m
[1;32m    572[0m [43m        [49m[43mread_only[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    573[0m [43m        [49m[43mdata_only[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    574[0m [43m        [49m[43mkeep_links[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    575[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mengine_kwargs[49m[43m,[49m
[1;32m    576[0m [43m    [49m[43m)[49m

File [0;32m~/269382/.venv/lib/python3.10/site-packages/openpyxl/reader/excel.py:346[0m, in [0;36mload_workbook[0;34m(filename, read_only, keep_vba, data_only, keep_links, rich_text)[0m
[1;32m    316[0m [38;5;250m[39m[38;5;124;03m"""Open the given filename and return the workbook[39;00m
[1;32m    317[0m 
[1;32m    318[0m [38;5;124;03m:param filename: the path to open or a file-like object[39;00m
[0;32m   (...)[0m
[1;32m    342[0m 
[1;32m    343[0m [38;5;124;03m"""[39;00m
[1;32m    344[0m reader [38;5;241m=[39m ExcelReader(filename, read_only, keep_vba,
[1;32m    345[0m                      data_only, keep_links, rich_text)
[0;32m--> 346[0m [43mreader[49m[38;5;241;43m.[39;49m[43mread[49m[43m([49m[43m)[49m
[1;32m    347[0m [38;5;28;01mreturn[39;00m reader[38;5;241m.[39mwb

File [0;32m~/269382/.venv/lib/python3.10/site-packages/openpyxl/reader/excel.py:287[0m, in [0;36mExcelReader.read[0;34m(self)[0m
[1;32m    285[0m action [38;5;241m=[39m [38;5;124m"[39m[38;5;124mread manifest[39m[38;5;124m"[39m
[1;32m    286[0m [38;5;28;01mtry[39;00m:
[0;32m--> 287[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mread_manifest[49m[43m([49m[43m)[49m
[1;32m    288[0m     action [38;5;241m=[39m [38;5;124m"[39m[38;5;124mread strings[39m[38;5;124m"[39m
[1;32m    289[0m     [38;5;28mself[39m[38;5;241m.[39mread_strings()

File [0;32m~/269382/.venv/lib/python3.10/site-packages/openpyxl/reader/excel.py:134[0m, in [0;36mExcelReader.read_manifest[0;34m(self)[0m
[1;32m    133[0m [38;5;28;01mdef[39;00m [38;5;21mread_manifest[39m([38;5;28mself[39m):
[0;32m--> 134[0m     src [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43marchive[49m[38;5;241;43m.[39;49m[43mread[49m[43m([49m[43mARC_CONTENT_TYPES[49m[43m)[49m
[1;32m    135[0m     root [38;5;241m=[39m fromstring(src)
[1;32m    136[0m     [38;5;28mself[39m[38;5;241m.[39mpackage [38;5;241m=[39m Manifest[38;5;241m.[39mfrom_tree(root)

File [0;32m/usr/lib/python3.10/zipfile.py:1476[0m, in [0;36mZipFile.read[0;34m(self, name, pwd)[0m
[1;32m   1474[0m [38;5;250m[39m[38;5;124;03m"""Return file bytes for name."""[39;00m
[1;32m   1475[0m [38;5;28;01mwith[39;00m [38;5;28mself[39m[38;5;241m.[39mopen(name, [38;5;124m"[39m[38;5;124mr[39m[38;5;124m"[39m, pwd) [38;5;28;01mas[39;00m fp:
[0;32m-> 1476[0m     [38;5;28;01mreturn[39;00m [43mfp[49m[38;5;241;43m.[39;49m[43mread[49m[43m([49m[43m)[49m

File [0;32m/usr/lib/python3.10/zipfile.py:911[0m, in [0;36mZipExtFile.read[0;34m(self, n)[0m
[1;32m    909[0m     [38;5;28mself[39m[38;5;241m.[39m_offset [38;5;241m=[39m [38;5;241m0[39m
[1;32m    910[0m     [38;5;28;01mwhile[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39m_eof:
[0;32m--> 911[0m         buf [38;5;241m+[39m[38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_read1[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mMAX_N[49m[43m)[49m
[1;32m    912[0m     [38;5;28;01mreturn[39;00m buf
[1;32m    914[0m end [38;5;241m=[39m n [38;5;241m+[39m [38;5;28mself[39m[38;5;241m.[39m_offset

File [0;32m/usr/lib/python3.10/zipfile.py:1015[0m, in [0;36mZipExtFile._read1[0;34m(self, n)[0m
[1;32m   1013[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_left [38;5;241m<[39m[38;5;241m=[39m [38;5;241m0[39m:
[1;32m   1014[0m     [38;5;28mself[39m[38;5;241m.[39m_eof [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m-> 1015[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_update_crc[49m[43m([49m[43mdata[49m[43m)[49m
[1;32m   1016[0m [38;5;28;01mreturn[39;00m data

File [0;32m/usr/lib/python3.10/zipfile.py:943[0m, in [0;36mZipExtFile._update_crc[0;34m(self, newdata)[0m
[1;32m    941[0m [38;5;66;03m# Check the CRC if we're at the end of the file[39;00m
[1;32m    942[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_eof [38;5;129;01mand[39;00m [38;5;28mself[39m[38;5;241m.[39m_running_crc [38;5;241m!=[39m [38;5;28mself[39m[38;5;241m.[39m_expected_crc:
[0;32m--> 943[0m     [38;5;28;01mraise[39;00m BadZipFile([38;5;124m"[39m[38;5;124mBad CRC-32 for file [39m[38;5;132;01m%r[39;00m[38;5;124m"[39m [38;5;241m%[39m [38;5;28mself[39m[38;5;241m.[39mname)

[0;31mBadZipFile[0m: Bad CRC-32 for file '[Content_Types].xml'

